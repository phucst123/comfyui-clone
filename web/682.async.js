"use strict";(self.webpackChunkgenerative_flow=self.webpackChunkgenerative_flow||[]).push([[682],{1794:function(ye,G,e){e.d(G,{Fh:function(){return E},aU:function(){return _e},bu:function(){return pe},u3:function(){return V},wo:function(){return N}});var B=e(8305),C=e.n(B),$=e(6068),S=e.n($),x=e(228),o=e.n(x),q=e(7999),c=e.n(q),A=e(4565),i=e(6952),_e=function(){var R=c()(o()().mark(function y(){return o()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,fetch((0,A.l9)("/object_info"));case 2:return m.abrupt("return",m.sent.json());case 3:case"end":return m.stop()}},y)}));return function(){return R.apply(this,arguments)}}(),N=function(){var R=c()(o()().mark(function y(){return o()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,fetch((0,A.l9)("/queue"));case 2:return m.abrupt("return",m.sent.json());case 3:case"end":return m.stop()}},y)}));return function(){return R.apply(this,arguments)}}(),pe=function(){var R=c()(o()().mark(function y(I){return o()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,fetch((0,A.l9)("/queue"),{method:"POST",body:JSON.stringify({delete:[I]})});case 2:case"end":return g.stop()}},y)}));return function(I){return R.apply(this,arguments)}}(),J=null,V=function(){var R=c()(o()().mark(function y(I){var m,g;return o()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,fetch((0,A.l9)("/prompt"),{method:"POST",body:JSON.stringify(I)});case 2:if(m=v.sent,m.status===200){v.next=9;break}return v.next=6,m.text();case 6:v.t0=v.sent,v.next=10;break;case 9:v.t0=void 0;case 10:return g=v.t0,v.abrupt("return",{error:g});case 12:case"end":return v.stop()}},y)}));return function(I){return R.apply(this,arguments)}}(),ee=function R(y){var I=y.map(function(m){if(m.sourceHandle==="*"){var g=y.find(function(P){return P.target===m.source});return S()(S()({},m),{},{source:g.source,sourceHandle:g.sourceHandle})}return m});return I.find(function(m){return m.sourceHandle==="*"})?R(I):I.filter(function(m){return m.targetHandle!=="*"})},E=function(y){var I=y.graph,m=y.widgets,g=y.customWidgets,P=y.clientId,v={},w={};Object.entries(I.data).forEach(function(O){var ne=C()(O,2),ie=ne[0],Y=ne[1];if(!g.includes(Y.value.widget)){var me=S()({},Y.value.fields);Object.entries(me).forEach(function(be){var je=C()(be,2),_=je[0],d=je[1],s=m[Y.value.widget].input.required[_];i.l.isInt(s)&&s[1].randomizable&&d===-1&&(me[_]=Math.trunc(Math.random()*Number.MAX_SAFE_INTEGER))}),w[ie]={position:Y.position,value:S()(S()({},Y.value),{},{fields:me})},v[ie]={class_type:Y.value.widget,inputs:me}}});var K=ee(I.connections);return console.log(K),K.forEach(function(O){var ne=I.data[O.source];if(ne){var ie=m[ne.value.widget].output.findIndex(function(Y){return Y===O.sourceHandle});v[O.target]&&(v[O.target].inputs[O.targetHandle]=[O.source,ie])}}),{prompt:v,client_id:P,extra_data:{extra_pnginfo:{workflow:{connections:K,data:w}}}}}},3592:function(ye,G,e){e.d(G,{i:function(){return V}});var B=e(6068),C=e.n(B),$=e(4560),S=function(E,R){var y=$.Z.darkAlgorithm(E,R);return C()({},y)},x=function(E){var R={algorithm:[$.Z.compactAlgorithm]};return E==="dark"&&R.algorithm.push(S),R},o=e(5910),q=e(5955),c=e(7854),A=e(4860),i=e(1263),_e=e(7298),N=e(8200),pe=e(1527),J=function(E){var R=(0,q.S)(),y=x(E),I={colorBgContainer:R==null?void 0:R.colorFillQuaternary,colorBorder:"transparent",controlHeightSM:24,controlOutline:"transparent"};return y.components={Input:I,InputNumber:I,Select:I,Tree:{colorBgContainer:void 0,controlHeightSM:24},TreeSelect:I},y},V=function(E){var R=E.children,y=E.componentToken;(0,c.Us)({ThemeContext:_e.Ni});var I=(0,o.q)(function(w){return{themeMode:w.themeMode}},N.X),m=I.themeMode,g=(0,A.r)(),P=g.appearance,v=J(P);return y&&(v.components=C()(C()({},v.components),y)),(0,pe.jsx)(i.f6,{theme:v,themeMode:m,children:R})}},4434:function(ye,G,e){e.d(G,{I:function(){return V},K:function(){return E}});var B=e(6068),C=e.n(B),$=e(7825),S=e.n($),x=e(3649),o=e.n(x),q=e(1263),c=e(1534),A=e(3592),i=e(1527),_e=["className"],N=["className"],pe,J=(0,q.kc)(function(R){var y=R.stylish,I=R.css;return I(pe||(pe=o()([`
    `,`
  `])),y.controlContainer)}),V=function(y){var I=y.className,m=S()(y,_e),g=J(),P=g.styles,v=g.cx;return(0,i.jsx)(A.i,{children:(0,i.jsx)(c.Z,C()(C()({},m),{},{className:v(P,I)}))})},ee=c.Z.TextArea,E=function(y){var I=y.className,m=S()(y,N),g=J(),P=g.styles,v=g.cx;return(0,i.jsx)(A.i,{children:(0,i.jsx)(ee,C()(C()({},m),{},{className:v(P,I)}))})}},5762:function(ye,G,e){e.d(G,{f:function(){return Ye},Z:function(){return Xe}});var B=e(8305),C=e.n(B),$=e(6068),S=e.n($),x=e(4434),o=e(1527),q=["","#f5222d","#fa541c","#fa8c16","#faad14","#fadb14","#a0d911","#52c41a","#13c2c2","#1677ff"],c=q.map(function(te,l){return{label:(0,o.jsx)("div",{style:{background:te||"#eee",width:16,height:16,borderRadius:"50%"}}),key:l}}),A=e(5910),i=e(5135),_e=e(2806),N=e(434),pe=e(346),J=e(4528),V=e(1263),ee=e(8314),E=e(959),R=e(2508),y=e(8200),I=e(262),m=e(6952),g=e(520),P=e(4565),v=e(2473),w=e(7467),K=function(l){var D=l.data,b=(0,E.useCallback)(function(u){var T=u.image,H=u.index;return(0,o.jsx)(v.Z,{height:"100%",src:(0,P.l9)(w.Z.stringifyUrl({url:"/view",query:T})),fallback:g.z2},H)},[]);return!D||D.length===0?null:(0,o.jsx)(v.Z.PreviewGroup,{children:D.map(b).reverse()})},O=E.memo(K),ne=e(1158),ie=e(6052),Y=e(1012),me=function(l){var D=l.label,b=l.type,u=l.position,T=l.slotType,H=l.isRequired,ce=(0,A.q)(function(U){return{nodes:U.nodes}},y.X),Pe=ce.nodes,fe=(0,E.useCallback)(function(U){if(U.targetHandle==="*"||U.sourceHandle==="*")return!0;try{var M,W=(M=Pe.find(function(L){return L.id===U.target}))===null||M===void 0?void 0:M.data.input.required[String(U.targetHandle)][0];(0,ie.Z)(W)&&(W="STRING");var oe=U.sourceHandle;return W===oe}catch(L){return!0}},[Pe]);return(0,o.jsxs)(I.g7,{$position:u,$isRequired:H?1:0,children:[(0,o.jsx)(R.HH,{id:D,type:b,position:u,isValidConnection:fe}),(0,o.jsx)("h5",{title:Array.isArray(T)?"STRING":T,style:{marginBottom:2},children:(0,Y.Z)(D.toLowerCase())})]})},be=me,je=function(l){var D=l.data;return D!=null&&D.length?(0,o.jsx)(I.zw,{children:D.map(function(b){var u=b.name,T=b.type;return(0,o.jsx)(be,{slotType:T,label:u,type:"target",position:ne.Ly.Left,isRequired:!0},u)})}):(0,o.jsx)("div",{})},_=E.memo(je),d=function(l){var D=l.data;return D!=null&&D.length?(0,o.jsx)(I.zw,{children:D.map(function(b){return(0,o.jsx)(be,{slotType:b,label:b,type:"source",position:ne.Ly.Right,isRequired:!0},b)})}):(0,o.jsx)("div",{})},s=E.memo(d),n=e(4619),t=e(8429),r=e(5558),a=e.n(r),p=e(3649),f=e.n(p),h=e(1800),F=e(3592),k,j=(0,V.kc)(function(te){var l=te.css,D=te.stylish,b=te.prefixCls,u="".concat(b,"-select"),T=":not(.".concat(u,"-disabled):not(.").concat(u,"-customize-input)");return l(k||(k=f()([`
    &.`,` {
      &-multiple:not(&-customize-input) &.`,`-selector {
        `,`;
      }

      &`,` {
        &:hover {
          .`,`-selector {
            border-color: transparent;
            `,`;
          }
        }
      }

      &-focused`,` {
        &:hover {
          .`,`-selector {
            `,`;
          }
        }

        .`,`-selector {
          `,`;
        }
      }
    }

    .`,` {
      &-arrow {
        top: 13px;
        right: 8px;

        width: 10px;
        height: 10px;

        font-size: 10px;
      }
    }
  `])),u,u,D.controlContainer,T,u,D.controlContainer,T,u,D.controlContainerFocused,u,D.controlContainerFocused,u)}),z=function(l){var D=j(),b=D.styles,u=D.cx;return(0,o.jsx)(F.i,{children:(0,o.jsx)(h.Z,S()(S()({},l),{},{className:u(b,l.className)}))})},re=e(5636),se=e(4194),Z=e(1359),ge=function(l){var D=l.value,b=l.input,u=l.onChange,T=l.name,H=(0,E.useState)([]),ce=C()(H,2),Pe=ce[0],fe=ce[1],U=(0,A.q)(function(L){return L},y.X),M=U.onRefresh,W=U.widgets;(0,E.useEffect)(function(){var L,X,he,Ce=W.LoadImage,Oe=T==="image"?Ce==null||(L=Ce.input)===null||L===void 0||(L=L.required)===null||L===void 0||(L=L.image)===null||L===void 0?void 0:L[0]:b==null?void 0:b[0],we=(X=Oe==null?void 0:Oe.filter(function(de){return!de.includes("\\")}).map(function(de){return{value:de,label:de}}))!==null&&X!==void 0?X:[],xe=(he=Oe==null?void 0:Oe.filter(function(de){return de.includes("\\")}).reduce(function(de,Ee){var Ie=Ee.split("\\"),ue=C()(Ie,2),Q=ue[0],ke=ue[1];return de[Q]||(de[Q]=[]),de[Q].push({value:Ee,label:ke}),de},{}))!==null&&he!==void 0?he:{},Le=[].concat(a()(we),a()(Object.entries(xe).map(function(de){var Ee=C()(de,2),Ie=Ee[0],ue=Ee[1];return{label:Ie,options:ue}})));fe(Le)},[b,T,W]);var oe=(0,E.useCallback)(function(L){var X;L.file.status==="done"&&M();var he=(X=L.file.response)===null||X===void 0?void 0:X.name;he&&u(he)},[u,M]);return(0,o.jsxs)(o.Fragment,{children:[T==="image"&&(0,o.jsx)(se.Z.Dragger,{accept:".png, .jpg, .jpeg, .webp",style:{margin:"8px 0"},itemRender:function(){return null},name:"image",action:function(){return(0,P.l9)("/upload/image")},maxCount:1,onChange:oe,children:(0,o.jsxs)(Z.Z,{children:[(0,o.jsx)(re.Z,{}),"Click or drag img to upload"]})}),(0,o.jsx)(z,{showSearch:!0,placeholder:"Search to Select",optionFilterProp:"children",filterOption:function(X,he){var Ce;return String((Ce=he==null?void 0:he.label)!==null&&Ce!==void 0?Ce:"").toLowerCase().includes(X.toLowerCase())},style:{width:"100%"},size:"small",value:D,defaultValue:b[0][0],onChange:u,options:Pe})]})},le=E.memo(ge),ae=e(7825),De=e.n(ae),Re=e(9956),Se=["className"],ve,Ae=(0,V.kc)(function(te){var l=te.stylish,D=te.css,b=te.token;return D(ve||(ve=f()([`
      `,`

      .`,`-input-number-group-addon {
        padding: 0 4px;
        color: `,`;
        background: `,`;
        border-color: transparent;
      }
    `])),l.controlContainer,g.xb,b.colorTextTertiary,b.colorFillQuaternary)}),Te=function(l){var D=l.className,b=De()(l,Se),u=Ae(),T=u.styles,H=u.cx;return(0,o.jsx)(F.i,{children:(0,o.jsx)(Re.Z,S()(S()({size:"small"},b),{},{className:H(T,D)}))})},Ne=e(7794),Fe=e(7298),Ge=Fe.ZP.div.withConfig({componentId:"sc-azuxda-0"})(["display:flex;"]),Me=Fe.ZP.div.withConfig({componentId:"sc-azuxda-1"})(["display:flex;flex:",";align-items:center;justify-content:flex-start;> *{width:100%;}"],function(te){var l=te.span;return l}),We=function(l){var D=l.name,b=l.value,u=l.min,T=l.max,H=l.step,ce=l.style,Pe=l.onChange,fe=(0,A.q)(function(Q){return Q},y.X),U=fe.counter,M=(0,E.useState)(b),W=C()(M,2),oe=W[0],L=W[1],X=(0,E.useState)(!1),he=C()(X,2),Ce=he[0],Oe=he[1],we=D==="seed",xe=(0,E.useMemo)(function(){var Q=T,ke=u,He=H;switch(D){case"steps":T=200;break;case"cfg":T=32,H=.5;break;case"width":T=4096,u=512,H=4;break;case"height":T=4096,u=512,H=4;break;default:break}return{iMax:Q,iMin:ke,iStep:He}},[D,T,u,H]),Le=xe.iMax,de=xe.iMin,Ee=xe.iStep,Ie=(0,E.useCallback)(function(Q){var ke,He=Number(Q!=null&&(ke=Q.target)!==null&&ke!==void 0&&ke.value?Q.target.value:Q);isNaN(He)||(L(He),Pe(He))},[Pe]),ue=(0,E.useCallback)(function(Q){Oe(Q.target.checked)},[]);return(0,E.useEffect)(function(){!we||!Ce||Ie(Math.floor(Math.random()*Le))},[U,Le]),(0,o.jsxs)(Ge,{style:ce,children:[(0,o.jsx)(Me,{span:we?12:4,style:{marginRight:12},children:(0,o.jsx)(Te,{style:{width:"100%"},min:de,max:Le,step:Ee,value:Number(oe),onBlur:Ie,onPressEnter:Ie})}),(0,o.jsx)(Me,{span:we?4:12,children:we?(0,o.jsx)(n.Z,{checked:Ce,onChange:ue,children:"Random"}):(0,o.jsx)(Ne.Z,{min:de,max:Le,onChange:Ie,value:Number(oe),step:Ee})})]})},Ue=E.memo(We),Be=function(l){var D=l.id,b=l.name,u=l.input,T=(0,A.q)(function(fe){var U;return{value:(U=fe.graph[D])===null||U===void 0?void 0:U.fields[b],onChange:(0,t.Z)(function(M){var W;return fe.onPropChange(D,b,M!=null&&(W=M.target)!==null&&W!==void 0&&W.value?M.target.value:M)},100)}},y.X),H=T.value,ce=T.onChange;if(m.l.isList(u))return(0,o.jsx)(le,{value:H,name:b,input:u,onChange:ce});if(m.l.isBool(u))return(0,o.jsx)(n.Z,{value:H,defaultChecked:u[1].default,onChange:ce});if(m.l.isInt(u))return(0,o.jsx)(Ue,{name:b.toLowerCase(),style:{width:"100%"},value:Number(H!==null?H:u[1].default),max:Number(u[1].max),min:Number(u[1].min),onChange:function(U){var M;return ce(Number(U!=null&&(M=U.target)!==null&&M!==void 0&&M.value?U.target.value:U))}});if(m.l.isFloat(u))return(0,o.jsx)(Ue,{name:b.toLowerCase(),style:{width:"100%"},step:.01,value:Number(H!==null?H:u[1].default),max:Number(u[1].max),min:Number(u[1].min),onChange:function(U){var M;return ce(Number(U!=null&&(M=U.target)!==null&&M!==void 0&&M.value?U.target.value:U))}});if(m.l.isString(u)){var Pe=u[1];return Pe.multiline===!0?(0,o.jsx)(x.K,{style:{height:128,width:"100%"},defaultValue:H,onBlur:ce}):(0,o.jsx)(x.I,{style:{width:"100%"},value:H,onChange:ce})}return null},Je=E.memo(Be),Ve=function(l){var D=l.data,b=l.nodeId;return D!=null&&D.length?(0,o.jsx)("div",{onClick:function(T){return T.stopPropagation()},children:D.map(function(u){var T=u.name,H=u.type,ce=u.input;return(0,o.jsxs)("div",{children:[(0,o.jsx)(be,{slotType:H,label:T,type:"target",position:ne.Ly.Left,isRequired:!1}),(0,o.jsx)(Je,{name:T,id:b,input:ce}),(0,o.jsx)("div",{style:{height:4}})]},T)})}):null},Ke=E.memo(Ve),ze=function(l){var D=l.id,b=l.data,u=b.input,T=b.output,H=(0,A.q)(function(M){var W;return{imagePreviews:(W=M.graph)===null||W===void 0||(W=W[D])===null||W===void 0||(W=W.images)===null||W===void 0?void 0:W.map(function(oe,L){return{image:oe,index:L}}).filter(Boolean),inputImgPreviews:[{image:{filename:M.onGetNodeFieldsData(D,"image"),type:"input"},index:0}].filter(function(oe){return oe.image.filename})}},y.X),ce=H.imagePreviews,Pe=H.inputImgPreviews,fe=(0,E.useMemo)(function(){var M=[];return Object.entries(u.required).forEach(function(W){var oe=C()(W,2),L=oe[0],X=oe[1];m.l.isParameterOrList(X)&&M.push({name:L,type:X[0],input:X})}),M},[u]),U=(0,E.useMemo)(function(){var M=[];return Object.entries(u.required).forEach(function(W){var oe=C()(W,2),L=oe[0],X=oe[1];m.l.isParameterOrList(X)||M.push({name:L,type:X[0]})}),u.optional&&Object.entries(u.optional).forEach(function(W){var oe=C()(W,2),L=oe[0],X=oe[1];m.l.isParameterOrList(X)||M.push({name:L,type:X[0]})}),M},[u]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(I.VA,{children:[(0,o.jsx)(_,{data:U}),(0,o.jsx)(s,{data:T})]}),(0,o.jsx)(Ke,{data:fe,nodeId:D}),(0,o.jsx)(O,{data:ce||Pe})]})},Ze=E.memo(ze),Ye="sdNode",Qe=function(l){var D;console.log("NodeComponent",l.data.name);var b=(0,E.useRef)(null),u=(0,A.q)(function(ue){var Q;return S()(S()({},ue),{},{progressBar:((Q=ue.nodeInProgress)===null||Q===void 0?void 0:Q.id)===l.id?ue.nodeInProgress.progress:void 0})},y.X),T=u.progressBar,H=u.onDuplicateNode,ce=u.onDeleteNode,Pe=u.onModifyChange,fe=(0,V.Fg)(),U=(0,E.useState)(!1),M=C()(U,2),W=M[0],oe=M[1],L=T!==void 0,X=l.selected,he=((D=l.data)===null||D===void 0?void 0:D.nickname)||l.data.name,Ce=l.data.name==="Group",Oe=function(Q){var ke=Q.target.value;Pe(l.id,"nickname",ke),oe(!1)},we=function(Q){var ke=Q.key;Pe(l.id,"color",q[ke])},xe=[{icon:(0,o.jsx)(i.Z,{}),label:"Rename",key:"rename",onClick:function(){return oe(!0)}},{icon:(0,o.jsx)(_e.Z,{}),label:"Colors",key:"colors",children:c,onClick:we},{type:"divider"},{icon:(0,o.jsx)(N.Z,{}),label:"Copy",key:"copy",onClick:function(){return H(l.id)}},{icon:(0,o.jsx)(pe.Z,{}),label:"Delete",key:"delete",onClick:function(){return ce(l.id)}}],Le=Ce?I.MW:I.OE,de;if(Ce){var Ee;de=(Ee=l.data)!==null&&Ee!==void 0&&Ee.color?(0,ee.m4)(l.data.color,.2):fe.colorFill}else{var Ie;de=(Ie=l.data)!==null&&Ie!==void 0&&Ie.color?(0,ee.CD)(.8,fe.colorBgContainer,l.data.color):fe.colorBgContainer}return(0,E.useEffect)(function(){var ue,Q=(ue=b.current)===null||ue===void 0?void 0:ue.parentNode;Q.setAttribute("type",l.data.name),b.current.setAttribute("type",l.data.name)},[]),(0,o.jsxs)(Le,{ref:b,size:"small",style:{background:de},title:W?(0,o.jsx)(x.I,{autoFocus:!0,defaultValue:he,onPressEnter:Oe,onBlur:Oe,size:"small",style:{margin:"4px 0",width:"100%"}}):he,active:L||X?1:0,hoverable:!Ce,extra:L?T>0&&(0,o.jsx)(J.Z,{steps:4,percent:Math.floor(T*100)}):(0,o.jsx)(o.Fragment,{}),children:[(0,o.jsx)(Ze,S()({},l)),X&&(0,o.jsx)(R.KP,{minWidth:80,minHeight:40})]})},Xe=E.memo(Qe)},262:function(ye,G,e){e.d(G,{MW:function(){return S},OE:function(){return $},VA:function(){return q},g7:function(){return x},zw:function(){return o}});var B=e(7380),C=e(7298),$=(0,C.ZP)(B.Z).withConfig({componentId:"sc-35fyyr-0"})(["min-width:80px;min-height:40px;box-shadow:",";",";.ant-card-head{height:15px;padding-right:3px;background:"," !important;border-bottom:unset;}"],function(c){var A=c.theme;return A.boxShadowTertiary},function(c){var A=c.active,i=c.theme;return A?(0,C.iv)(["outline:2px solid ",";"],i.colorPrimary):""},function(c){var A=c.theme;return A.colorFillQuaternary}),S=(0,C.ZP)(B.Z).withConfig({componentId:"sc-35fyyr-1"})(["min-width:80px;height:100%;min-height:120px;",";.react-flow__resize-control{pointer-events:all !important;}.ant-card-head{pointer-events:all !important;height:15px;padding-right:3px;background:"," !important;border-bottom:unset;}"],function(c){var A=c.active,i=c.theme;return A?(0,C.iv)(["outline:2px solid ",";"],i.colorPrimary):""},function(c){var A=c.theme;return A.colorFillQuaternary}),x=C.ZP.div.withConfig({componentId:"sc-35fyyr-2"})(["text-align:",";.react-flow__handle{top:unset;margin-top:10px;background:",";}"],function(c){var A=c.$position;return A},function(c){var A=c.$isRequired,i=c.theme;return A?i.colorPrimary:i.colorBorder}),o=C.ZP.div.withConfig({componentId:"sc-35fyyr-3"})(["flex:1;"]),q=C.ZP.div.withConfig({componentId:"sc-35fyyr-4"})(["display:flex;align-items:stretch;justify-content:stretch;width:100%;"])},520:function(ye,G,e){e.d(G,{k2:function(){return C},xb:function(){return B},z2:function(){return $}});var B="ant";function C(S,x){return x||(S?"".concat(B,"-").concat(S):B)}var $="data:image/webp;base64,UklGRnwFAABXRUJQVlA4WAoAAAAAAAAA/wEA/wEAVlA4IAgFAABQSACdASoAAgACAAAAJaW7hd2Eb84fxL/Fu2b+3YoPsf85/K75gdgO0n/cPKfeDJcf6jjA7zHCYHQ/3j/dfc97KfnX/r+4J/Mv6V/zesX+2XsH/p8mnzJ402iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iY02iBvOWQB3qAPUMTgyeNNomNNomNNo/WuFENRaRU20KzdBk8abRMabRMabZptNKNjzbhNu1hd33Bk8abRMabRMaqb/Kw49SfJ6z/CJMabRMabRMabZmhIYfVFsmHjNZuDy16fMnjTaJjVTjPW0tTJZLHerBQmq0eatO2jHzJ402iY05WHL7+aif7qE1/IHlqJjp8yeNNomNNomOgT5lutenzJ402iY02iiNGPr6y16fMnjTaJjTV4XIBX7qr95uFey16fMnjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJjTaJh4AD+/+LjAAAAAAAAAAAC0rN37fkv7KNTSn+uqCrzce+ZFY+V2wLrwyvKnVnbWsbOXsdMkV78wpw6M5Ht0icrihssgqb5WJa130AMfeLeJ9cO1J09zwdzkLrF52YniIAf5by1ZJR0mRk5V3PL+ibKQy+xwP5TV+T4ump0K+LkZ+wBab78G4GSS/dSUn/muJIrSr1FKYQ2z+Oo/1cghL9BNsO6vmEYog/O+yhpCY29bMR0CXQYvzdg1F/tafnPHYkanS7zfqAUdz9T3liqmBomByf/0xab8CFnMjcUb+WakMeqRZmABEgjvkA0mKYwg38SWQh7/Vuo//EecvnIIU6s8PM/JtA563guvz/n96OwlyoBcJalNQg6XtTNvSAsoHYSMKv/MVt4tAew6OEoZPM7F0GglgJvJ9GZ1dQk/25kMpL351DoZAQ6rfvOizEs4ZuRe6hf/3HsGMMDbaPof/2ceBdX1Le/n4LtHkSExFcCQWXa/vLxe8xfHzvCfoWEH90DfhRSroCMjPo6VU/HbZqBX+ofhRw7+ZbW0v+jwjr24CaaKw0kd2zmn/hhn8Rqx/uUN9yZMB/pn3Bc8ThOFm7xZychuV93W7Q4q7IUHOFjTr3n4JuG+vn47m+DBSGXJL2jhcl0WB0cgW7Yw6xTQgWSBdJ67I/u/AKgIJTyPm2HzqrEx2sT5jp3uoehUB2ASMh4KwpBwVcIjeGYJ+/ICdC2AhxQiD5Rg7H2q+ggI00qhr0tQF9qrx2dAY2PwDASTq8cVMBwYpcMGadEMF7lQWxQv8sZ3YnQu0hWYSk6UE74i2ZSOL+0U4uWD5aUD92da9jCSaecnVKDk2U+mSLuEAAHPkRqknB/sBsy8YFWtSs0TSucCwKYBFVkOe0PikbUHR8/KX9OXKmcZgZDi4+9Phq53iAupQAAAAAAAAAAAAAAUFNBSU4AAAA4QklNA+0AAAAAABAASAAAAAEAAgBIAAAAAQACOEJJTQQoAAAAAAAMAAAAAj/wAAAAAAAAOEJJTQRDAAAAAAAOUGJlVwEQAAYAZAAAAAA="},1326:function(ye,G){var e={host:"localhost:8188",protocol:"http:"},B={host:"localhost:8188",protocol:"http:"},C=e;G.Z=C},858:function(ye,G){var e={data:{"d6488046-7e3d-45ce-b0cb-fc461ded790d":{value:{widget:"VAELoader",fields:{vae_name:"[\u9AD8\u9971\u548C] vae-ft-mse-840000.safetensors"}},position:{x:320,y:1219.5},width:319,height:120},"196c7067-dd8c-4b21-95bf-c7da1074359f":{value:{widget:"Group",fields:{},modify:{nickname:"Prompt"}},position:{x:320.6155722066724,y:1360.4647275134319},width:319,height:539},"2e19ea7c-a469-4aee-ba5f-50546f7b6856":{value:{widget:"PreviewImage",fields:{},images:[{filename:"ComfyUI_00015_.png",subfolder:"",type:"temp"}]},position:{x:959.9330329915367,y:1040.5498613443042},width:535,height:574},"2d69027b-18cb-4fba-a6f7-3cc6191da27a":{value:{widget:"EmptyLatentImage",fields:{width:512,height:512,batch_size:1}},position:{x:680,y:1040},width:240,height:246},"df10802c-dcb3-45cb-b61a-ed21c9435e54":{value:{widget:"VAEDecode",fields:{}},position:{x:680,y:1780},width:240,height:96},"3ab52db7-7835-409b-9742-cdbb84283789":{value:{widget:"KSampler",fields:{seed:0xb8ce6f395b97b000,steps:24,cfg:8,sampler_name:"dpm_2",scheduler:"normal",denoise:.99}},position:{x:680,y:1300},width:240,height:461},"03e009af-40ce-40f8-8678-ee811fe31f41":{value:{widget:"CLIPTextEncode",fields:{text:"bad had"},modify:{color:"#f5222d",nickname:"Negative"}},position:{x:19.384427793327575,y:280.91726159315385},width:280,height:228,parentId:"196c7067-dd8c-4b21-95bf-c7da1074359f"},"18d73b78-7fd7-4411-a39e-b8a17e677892":{value:{widget:"CLIPTextEncode",fields:{text:"beautiful mountain scenery"},modify:{color:"#52c41a",nickname:"Positive"}},position:{x:20,y:40.91726159315385},width:278,height:154,parentId:"196c7067-dd8c-4b21-95bf-c7da1074359f"},"1ab1ba4a-5dfb-4ced-bc06-2b55af930969":{value:{widget:"CheckpointLoaderSimple",fields:{ckpt_name:"CmShota\\CmShotaMix-Unreal.safetensors"},modify:{color:"#fadb14"}},position:{x:321.49999999999994,y:1041},width:317,height:148}},connections:[{source:"1ab1ba4a-5dfb-4ced-bc06-2b55af930969",sourceHandle:"MODEL",target:"3ab52db7-7835-409b-9742-cdbb84283789",targetHandle:"model"},{source:"1ab1ba4a-5dfb-4ced-bc06-2b55af930969",sourceHandle:"CLIP",target:"18d73b78-7fd7-4411-a39e-b8a17e677892",targetHandle:"clip"},{source:"1ab1ba4a-5dfb-4ced-bc06-2b55af930969",sourceHandle:"CLIP",target:"03e009af-40ce-40f8-8678-ee811fe31f41",targetHandle:"clip"},{source:"03e009af-40ce-40f8-8678-ee811fe31f41",sourceHandle:"CONDITIONING",target:"3ab52db7-7835-409b-9742-cdbb84283789",targetHandle:"negative"},{source:"18d73b78-7fd7-4411-a39e-b8a17e677892",sourceHandle:"CONDITIONING",target:"3ab52db7-7835-409b-9742-cdbb84283789",targetHandle:"positive"},{source:"2d69027b-18cb-4fba-a6f7-3cc6191da27a",sourceHandle:"LATENT",target:"3ab52db7-7835-409b-9742-cdbb84283789",targetHandle:"latent_image"},{source:"3ab52db7-7835-409b-9742-cdbb84283789",sourceHandle:"LATENT",target:"df10802c-dcb3-45cb-b61a-ed21c9435e54",targetHandle:"samples"},{source:"df10802c-dcb3-45cb-b61a-ed21c9435e54",sourceHandle:"IMAGE",target:"2e19ea7c-a469-4aee-ba5f-50546f7b6856",targetHandle:"images"},{source:"d6488046-7e3d-45ce-b0cb-fc461ded790d",sourceHandle:"VAE",target:"df10802c-dcb3-45cb-b61a-ed21c9435e54",targetHandle:"vae"}]};G.Z=e},5910:function(ye,G,e){e.d(G,{q:function(){return je}});var B=e(8305),C=e.n(B),$=e(2092),S=e.n($),x=e(5558),o=e.n(x),q=e(228),c=e.n(q),A=e(6068),i=e.n(A),_e=e(7999),N=e.n(_e),pe=e(1794),J=e(3406),V=e(5180),ee=e(7971),E=function(d){return d.class_type==="CLIPTextEncode"&&d.inputs.text!==void 0},R=function(d){return E(d)?[d.inputs.text]:[]},y=function(d,s){return d[3].client_id===s},I=function(){var _=N()(c()().mark(function d(s){var n;return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,pe.wo)();case 2:return n=r.sent,r.abrupt("return",n.queue_running.concat(n.queue_pending).filter(function(a){return y(a,s)}).map(function(a){var p,f=a[1],h=a[2],F=Object.values(h),k=F.flatMap(R),j=F.find(function(re){return re.class_type.startsWith("CheckpointLoader")}),z=j==null||(p=j.inputs)===null||p===void 0?void 0:p.ckpt_name;return{id:f,prompts:k,model:z}}));case 4:case"end":return r.stop()}},d)}));return function(s){return _.apply(this,arguments)}}(),m=e(7174),g=e(4565),P=function(){var _=N()(c()().mark(function d(){var s,n,t,r,a=arguments;return c()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:s=a.length>0&&a[0]!==void 0?a[0]:5e3,n=a.length>1&&a[1]!==void 0?a[1]:10,t=0;case 3:if(!(t<n)){f.next=21;break}return f.prev=4,f.next=7,m.Z.get((0,g.l9)("/history/123"));case 7:if(r=f.sent,r.status!==200){f.next=11;break}return console.log("Server is back online."),f.abrupt("return",!0);case 11:f.next=16;break;case 13:f.prev=13,f.t0=f.catch(4),console.log("Attempt ".concat(t+1,": Server still restarting..."));case 16:return t++,f.next=19,new Promise(function(h){return setTimeout(h,s)});case 19:f.next=3;break;case 21:return console.error("Server restart check timed out."),f.abrupt("return",!1);case 23:case"end":return f.stop()}},d,null,[[4,13]])}));return function(){return _.apply(this,arguments)}}(),v=function(){var _=N()(c()().mark(function d(){var s,n;return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,m.Z.get((0,g.l9)("/manager/reboot"),{headers:{"Content-Type":"application/json"}});case 3:if(s=r.sent,s.status!==200){r.next=10;break}return console.log("Reboot request sent. Checking server status..."),r.next=8,P(5e3,30);case 8:n=r.sent,console.log(n?"Server restart complete!":"Server did not come back online within the expected time.");case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(0),console.error("Error sending reboot request:",r.t0);case 15:case"end":return r.stop()}},d,null,[[0,12]])}));return function(){return _.apply(this,arguments)}}(),w=e(2508),K=e(4155),O=e(8826),ne=e(9951),ie=e(1825),Y={Group:{input:{required:{}},output:[],output_name:[],name:"Group",category:"Utils"},Reroute:{input:{required:S()({},"*",["*"])},output:["*"],output_name:[],name:"Reroute",category:"Utils"}},me=Y,be=e(8200),je=(0,ne.F)()((0,ie.mW)(function(_,d){return{messages:[{content:[{text:"Welcome! I'm ready to help you reach out to desired workflows."}],sender:"bot"}],page:"flow",counter:0,widgets:{},customWidgets:Object.keys(me),graph:{},nodes:[],edges:[],queue:[],gallery:[],themeMode:"auto",edgeType:"default",nodeInProgress:void 0,promptError:void 0,clientId:void 0,onSetPage:function(n){_({page:n},!1,"onSetPage")},onSetThemeMode:function(n){_({themeMode:n},!1,"onSetThemeMode")},onNewClientId:function(n){_({clientId:n},!1,"onNewClientId")},onRefresh:function(){var s=N()(c()().mark(function t(){var r;return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,pe.aU)();case 2:r=p.sent,_({widgets:i()(i()({},me),r)},!1,"onRefresh");case 4:case"end":return p.stop()}},t)}));function n(){return s.apply(this,arguments)}return n}(),onInit:function(){var s=N()(c()().mark(function t(){var r,a;return c()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return setInterval(function(){return d().onPersistTemp()},5e3),f.next=3,(0,pe.aU)();case 3:a=f.sent,_({widgets:i()(i()({},me),a)},!1,"onInit"),d().onLoadWorkflow((r=(0,J.Vj)())!==null&&r!==void 0?r:{data:{},connections:[]});case 6:case"end":return f.stop()}},t)}));function n(){return s.apply(this,arguments)}return n}(),onAddMessage:function(n){_(function(t){return{messages:[].concat(o()(t.messages),[n])}},!1,"onAddMessage")},onCreateGroup:function(){var n=d(),t=n.nodes,r=n.onDetachGroup,a=t.filter(function(j){return j.selected}).map(function(j){return r(j)});if(!(a.length<1)){var p=1/0,f=0,h=1/0,F=0;a.forEach(function(j){var z=j.position,re=z.x,se=z.y,Z=j.width,ge=j.height;p=Math.min(p,re),f=Math.max(f,re+Number(Z)),h=Math.min(h,se),F=Math.max(F,se+Number(ge))});var k={widget:me.Group,position:{x:p-40,y:h-60},width:f-p+80,height:F-h+100,key:(0,K.Z)()};_(function(j){return(0,V.gz)(j,k)},!1,"onCreateGroup")}},onSetNodesGroup:function(n,t){_(function(r){return{nodes:r.nodes.map(function(a){if(n.includes(a.id)){if(a.parentId===t.id)return a;a.parentId=t.id,a.position.x=a.position.x-t.position.x,a.position.y=a.position.y-t.position.y}else a.parentId===t.id&&(a.parentId=void 0,a.position.x=a.position.x+t.position.x,a.position.y=a.position.y+t.position.y);return a})}})},onDetachGroup:function(n){if(!n.parentId)return n;var t=d().nodes,r=t.find(function(a){return a.id===n.parentId});return i()(i()({},n),{},{parentId:void 0,position:{x:n.position.x+Number(r==null?void 0:r.position.x),y:n.position.y+Number(r==null?void 0:r.position.y)}})},onDetachNodesGroup:function(n,t){_(function(r){return{nodes:r.nodes.map(function(a){return n.includes(a.id)&&(a.parentId=void 0,a.position.x=a.position.x+t.position.x,a.position.y=a.position.y+t.position.y),a})}})},onNodesChange:function(n){_(function(t){return{nodes:(0,w.Fb)(n,t.nodes)}},!1,"onNodesChange")},onUpdateNodes:function(n,t){_(function(r){return{nodes:(0,V.tV)(n,t,r.nodes)}},!1,"onUpdateNodes")},onAddNode:function(n){_(function(t){return(0,V.gz)(t,n)},!1,"onAddNode")},onDeleteNode:function(n){var t=d().nodes,r=t.find(function(p){return p.id===n}),a=t.filter(function(p){return p.parentId===n}).map(function(p){return p.id});d().onDetachNodesGroup(a,r),_(function(p){return{nodes:(0,w.Fb)([{type:"remove",id:n}],p.nodes)}},!1,"onDeleteNode")},onDuplicateNode:function(n){_(function(t){var r=t.graph,a=t.nodes,p=t.widgets,f=r[n],h=a.find(function(z){return z.id===n}),F=h==null?void 0:h.position,k=F?i()(i()({},F),{},{y:F.y+(h.height||100)+24}):void 0,j=i()(i()({widget:p[f.widget],node:f,position:k},(h==null?void 0:h.width)&&{width:h.width}),(h==null?void 0:h.height)&&{height:h.height});return(0,V.gz)(t,j)},!1,"onDuplicateNode")},onNodeInProgress:function(n,t){_({nodeInProgress:{id:n,progress:t}},!1,"onNodeInProgress")},onPropChange:function(n,t,r){_(function(a){var p;a.onUpdateNodes(n,S()({},t,r));var f=i()(i()({},(p=a.graph[n])===null||p===void 0?void 0:p.fields),{},S()({},t,r)),h=i()(i()({},a.graph[n]),{},{fields:f}),F=i()(i()({},a.graph),{},S()({},n,h));return i()(i()({},a),{},{graph:F})},!1,"onPropChange")},onModifyChange:function(n,t,r){_(function(a){var p;a.onUpdateNodes(n,S()({},t,r));var f=i()(i()({},(p=a.graph[n])===null||p===void 0?void 0:p.modify),{},S()({},t,r)),h=i()(i()({},a.graph[n]),{},{modify:f}),F=i()(i()({},a.graph),{},S()({},n,h));return i()(i()({},a),{},{graph:F})},!1,"onModifyChange")},onGetNodeFieldsData:function(n,t){try{var r;return(r=d())===null||r===void 0||(r=r.graph[n])===null||r===void 0?void 0:r.fields[t]}catch(a){console.error(a)}},onCopyNode:function(){var n=d().nodes,t=n.filter(function(p){return p.selected}).map(function(p){return p.id}),r=(0,J.Mg)(d()),a={};return t.forEach(function(p){var f=r.data[p];if(f.parentId){var h=n.find(function(F){return F.id===f.parentId});a[p]=i()(i()({},f),{},{parentId:void 0,position:{x:f.position.x+Number(h==null?void 0:h.position.x),y:f.position.y+Number(h==null?void 0:h.position.y)}})}else a[p]=f}),r.data=a,r.connections=r.connections.filter(function(p){return t.includes(p.target)&&t.includes(p.source)}),r},onPasteNode:function(n,t){var r=(0,V.ug)(Object.values(n.data).map(function(k){return k.position})),a=(0,V.Xl)(n,r,t),p=a.data,f=a.idMap,h=(0,V.$V)(n,f),F=i()({data:p},h);_(function(k){return Object.entries(F.data).reduce(function(j,z){var re=C()(z,2),se=re[0],Z=re[1],ge=j.widgets[Z.value.widget];return ge?(0,V.gz)(j,{widget:ge,node:Z.value,position:Z.position,width:Z.width,height:Z.height,parentId:Z.parentId,key:se}):(console.warn("Unknown widget ".concat(Z.value.widget)),j)},h.connections.reduce(ee.H,k))},!0,"onPasteNode")},onEdgesChange:function(n){_({edges:(0,w.yn)(n,d().edges)},!1,"onEdgesChange")},onEdgesAnimate:function(n){_(function(t){return{edges:t.edges.map(function(r){return i()(i()({},r),{},{animated:n})})}},!1,"onEdgesAnimate")},onEdgesType:function(n){_(function(t){return{edges:t.edges.map(function(r){return i()(i()({},r),{},{type:n})})}},!1,"onEdgesType")},onConnect:function(n){_(function(t){return(0,ee.H)(t,n)},!1,"onConnect")},onImageSave:function(n,t){_(function(r){return{gallery:r.gallery.concat(t.map(function(a){return{image:a}})),graph:i()(i()({},r.graph),{},S()({},n,i()(i()({},r.graph[n]),{},{images:t})))}},!1,"onImageSave")},onSubmit:function(){var s=N()(c()().mark(function t(){var r,a,p;return c()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return r=d(),a=(0,J.Mg)(r),h.next=4,(0,pe.u3)((0,pe.Fh)({graph:a,widgets:r.widgets,customWidgets:r.customWidgets,clientId:r.clientId}));case 4:p=h.sent,_({promptError:p.error,counter:r.counter+1},!1,"onSubmit");case 6:case"end":return h.stop()}},t)}));function n(){return s.apply(this,arguments)}return n}(),onDeleteFromQueue:function(){var s=N()(c()().mark(function t(r){return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,pe.bu)(r);case 2:return p.next=4,d().onQueueUpdate();case 4:case"end":return p.stop()}},t)}));function n(t){return s.apply(this,arguments)}return n}(),onQueueUpdate:function(){var s=N()(c()().mark(function t(){return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=_,a.next=3,I(d().clientId);case 3:a.t1=a.sent,a.t2={queue:a.t1},(0,a.t0)(a.t2,!1,"onQueueUpdate");case 6:case"end":return a.stop()}},t)}));function n(){return s.apply(this,arguments)}return n}(),onPersistTemp:function(){(0,J.aA)((0,J.Mg)(d()))},onSaveLocalWorkFlow:function(n){(0,J.Eo)((0,J.Mg)(d()),n)},onLoadLocalWorkflow:function(n){var t=(0,J._h)(n);t&&d().onLoadWorkflow(t)},onUpdateLocalWorkFlowGraph:function(n){(0,J.iq)(n,{graph:(0,J.Mg)(d())})},onUpdateLocalWorkFlowTitle:function(n,t){(0,J.iq)(n,{title:t})},onLoadWorkflow:function(){var s=N()(c()().mark(function t(r){var a,p,f,h;return c()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(_(function(j){return i()(i()({},j),{},{nodes:[],edges:[],counter:0,graph:{}})},!1,"resetBeforeLoad"),!(0,J.TR)(r)){k.next=5;break}_(function(j){var z=j.widgets,re=i()(i()({},j),{},{nodes:[],edges:[],counter:0,graph:{}});return Object.entries(r.data).forEach(function(se){var Z=C()(se,2),ge=Z[0],le=Z[1],ae=z==null?void 0:z[le.value.widget];ae?re=(0,V.gz)(re,{widget:ae,node:le.value,position:le.position,width:le.width,height:le.height,key:ge,parentId:le.parentId}):console.warn("Unknown widget ".concat(le.value.widget))}),r.connections.forEach(function(se){re=(0,ee.H)(re,se)}),re},!1,"onLoadWorkflow-basic"),k.next=29;break;case 5:return O.Z.destroyAll(),O.Z.info({content:"Installing nodes, please wait...",centered:!0,footer:null,width:400}),k.next=9,m.Z.post("http://".concat("localhost:8188","/install_node"),{workflow:r},{headers:{"Content-Type":"application/json"}});case 9:if(a=k.sent,a.status===200){k.next=15;break}return O.Z.destroyAll(),O.Z.error({content:"Fail to install node",centered:!0,footer:null,width:400,height:400}),console.error("Failed to install node"),k.abrupt("return");case 15:return a.data.restart===!0&&(O.Z.destroyAll(),O.Z.info({content:"Restarting Server ...",centered:!0,footer:null,width:400,height:400}),v()),k.next=18,P();case 18:if(p=k.sent,p){k.next=24;break}return O.Z.destroyAll(),O.Z.error({content:"Server is not responding",centered:!0,width:400,height:400}),console.error("Server is not responding"),k.abrupt("return");case 24:O.Z.destroyAll(),f=1.5,h=(0,J.Pt)(r,d().widgets),Object.entries(h).forEach(function(j){var z,re=C()(j,2),se=re[0],Z=re[1],ge=(z=d().widgets)===null||z===void 0?void 0:z[Z.class_type];if(ge){var le={widget:Z.class_type,fields:Object.fromEntries(Object.entries(Z.inputs).filter(function(ve){var Ae=C()(ve,2),Te=Ae[0],Ne=Ae[1];return!Array.isArray(Ne)}))},ae=r.nodes.find(function(ve){return ve.id.toString()===se}),De={x:ae?ae.pos[0]*f:0,y:ae?ae.pos[1]*f:0},Re=ae?ae.size[0]:400,Se=ae?ae.size[1]:400;_(function(ve){return(0,V.gz)(ve,{widget:ge,node:le,position:De,width:Re,height:Se,key:se})},!1,"onLoadWorkflow-addNode-advance")}else console.warn("Unknown widget ".concat(Z.class_type))}),Object.entries(h).forEach(function(j){var z=C()(j,2),re=z[0],se=z[1];Object.entries(se.inputs).forEach(function(Z){var ge=C()(Z,2),le=ge[0],ae=ge[1];if(Array.isArray(ae)){var De,Re=le,Se=re,ve=ae[0],Ae;if(h[ve].class_type==="Reroute"?Ae="*":Ae=(De=r.nodes.find(function(Te){return Te.id.toString()===ve}).outputs)===null||De===void 0||(De=De[ae[1]])===null||De===void 0?void 0:De.type,console.log("Source: ",ve,"SourceHandle: ",Ae,"Target: ",Se,"TargetHandle: ",Re),!Ae){console.warn("No valid source handle for node: ".concat(ve,", output index: ").concat(ae[1],", skipping connection"));return}_(function(Te){return(0,ee.H)(Te,{source:ve,sourceHandle:Ae,target:Se,targetHandle:Re})},!1,"onLoadWorkflow-addConnection-advance")}})});case 29:console.log("step 4");case 30:case"end":return k.stop()}},t)}));function n(t){return s.apply(this,arguments)}return n}(),onDownloadWorkflow:function(){(0,J.Cq)((0,J.Mg)(d()))}}}),be.X)},7971:function(ye,G,e){e.d(G,{H:function(){return S},g:function(){return x}});var B=e(6068),C=e.n(B),$=e(1158),S=function(q,c){var A=q.edges,i=c.targetHandle,_e=c.target;return C()(C()({},q),{},{edges:(0,$.Z_)(c,A.filter(function(N){return!(N.targetHandle===i&&N.target===_e)}))})},x=function(q){return q.edges.flatMap(function(c){var A=c.source,i=c.sourceHandle,_e=c.target,N=c.targetHandle;return i!=null&&i.length&&N!==null&&N!==void 0&&N.length?[{source:A,sourceHandle:i,target:_e,targetHandle:N}]:[]})}},4565:function(ye,G,e){e.d(G,{l9:function(){return C}});var B=e(1326),C=function(S){return"".concat(B.Z.protocol,"//").concat(B.Z.host).concat(S)}},6952:function(ye,G,e){e.d(G,{l:function(){return q}});var B=e(5298),C=e.n(B),$=e(7069),S=e.n($),x=e(6052),o=function(){function c(){C()(this,c)}return S()(c,[{key:"isBool",value:function(i){return(0,x.Z)(i)?i[0]==="BOOLEAN":!1}},{key:"isInt",value:function(i){return(0,x.Z)(i)?i[0]==="INT":!1}},{key:"isFloat",value:function(i){return(0,x.Z)(i)?i[0]==="FLOAT":!1}},{key:"isString",value:function(i){return(0,x.Z)(i)?i[0]==="STRING":!1}},{key:"isList",value:function(i){return(0,x.Z)(i)?Array.isArray(i[0]):!1}},{key:"isParameterOrList",value:function(i){return(0,x.Z)(i)?this.isBool(i)||this.isInt(i)||this.isFloat(i)||this.isString(i)||this.isList(i):!1}}]),c}(),q=new o},5180:function(ye,G,e){e.d(G,{gz:function(){return pe},$V:function(){return I},Xl:function(){return y},yY:function(){return V},rf:function(){return ee},ug:function(){return E},tV:function(){return J}});var B=e(8305),C=e.n(B),$=e(2092),S=e.n($),x=e(6068),o=e.n(x),q=e(5762),c=e(2508),A=e(4155),i=e(6952),_e=function(g){var P={};return Object.entries(g.input.required).forEach(function(v){var w=C()(v,2),K=w[0],O=w[1];if(i.l.isBool(O)){var ne;P[K]=(ne=O[1].default)!==null&&ne!==void 0?ne:!1}else if(i.l.isFloat(O)){var ie;P[K]=(ie=O[1].default)!==null&&ie!==void 0?ie:0}else if(i.l.isInt(O)){var Y;P[K]=(Y=O[1].default)!==null&&Y!==void 0?Y:0}else i.l.isString(O)?P[K]="":i.l.isList(O)&&(P[K]=O[0][0])}),P},N=function(g){return{widget:g.name,fields:_e(g)}},pe=function(g,P){var v,w=P.widget,K=P.node,O=P.position,ne=O===void 0?{x:0,y:0}:O,ie=P.width,Y=P.height,me=P.key,be=P.parentId,je=String(me!=null?me:(0,A.Z)()),_=g.nodes.map(function(s){var n;return(n=s.zIndex)!==null&&n!==void 0?n:0}).concat([0]).reduce(function(s,n){return Math.max(s,n)})+1,d={id:je,type:q.f,data:o()(o()({},w),(v=K==null?void 0:K.modify)!==null&&v!==void 0?v:{}),dragHandle:".ant-card-head",position:ne,zIndex:_,width:ie,height:Y,parentId:be,style:{width:ie,height:Y}};return o()(o()({},g),{},{nodes:(0,c.Fb)([{type:"add",item:d}],g.nodes),graph:o()(o()({},g.graph),{},S()({},je,K!=null?K:N(w)))})},J=function(g,P,v){return v.map(function(w){return w.id===g&&(w.data=o()(o()({},w.data),P)),w})},V=function(g,P,v){return v.screenToFlowPosition({x:g,y:P})},ee=function(g,P){var v=P.getViewport(),w=v.x,K=v.y,O=v.zoom,ne=g.current.offsetWidth,ie=g.current.offsetHeight;return{x:Math.floor((ne/2-w)/O),y:Math.floor((ie/2-K)/O)}},E=function(g){for(var P=g[0],v=1;v<g.length;v++){var w=g[v];(w.x<P.x||w.x===P.x&&w.y<P.y)&&(P=w)}return P},R=function(g,P,v){return o()(o()({},g),{},{position:{x:Math.floor(g.position.x-P.x+v.x),y:Math.floor(g.position.y-P.y+v.y)},key:(0,A.Z)()})},y=function(g,P,v){return Object.entries(g.data).reduce(function(w,K){var O=C()(K,2),ne=O[0],ie=O[1],Y=R(ie,P,v);return{data:o()(o()({},w.data),{},S()({},Y.key,Y)),idMap:o()(o()({},w.idMap),{},S()({},ne,Y.key))}},{data:{},idMap:{}})},I=function(g,P){return{connections:g.connections.map(function(v){return o()(o()({},v),{},{source:P[v.source],target:P[v.target]})})}}},3406:function(ye,G,e){e.d(G,{Cq:function(){return ne},Eo:function(){return w},Mg:function(){return E},Pt:function(){return be},Sf:function(){return v},Sk:function(){return O},TR:function(){return ie},Vj:function(){return y},W:function(){return R},_h:function(){return P},aA:function(){return I},iq:function(){return K},qW:function(){return g}});var B=e(8305),C=e.n(B),$=e(335),S=e.n($),x=e(1759),o=e.n(x),q=e(228),c=e.n(q),A=e(7999),i=e.n(A),_e=e(6068),N=e.n(_e),pe=e(7971),J=e(858),V="kitchen-flow-temp",ee="kitchen-flow-local",E=function(d){var s={};return d.nodes.forEach(function(n){var t=d.graph[n.id];t!==void 0&&(s[n.id]={value:t,position:n.position},n.width&&(s[n.id].width=n.width),n.height&&(s[n.id].height=n.height),n.parentId&&(s[n.id].parentId=n.parentId))}),{data:s,connections:(0,pe.g)(d)}},R=function(){try{localStorage.removeItem(V)}catch(d){console.log("[cleanTempWorkflow]",d)}},y=function(){var d=localStorage.getItem(V);return d?JSON.parse(d):J.Z},I=function(d){try{localStorage.setItem(V,JSON.stringify(d))}catch(s){console.log("[saveTempWorkflow]",s)}},m=function(){try{localStorage.removeItem(ee)}catch(d){console.log("[cleanLocalWorkflows]",d)}},g=function(){try{var d=localStorage.getItem(ee);return d?JSON.parse(d):[]}catch(s){return console.log("[retrieveLocalWorkflows]",s),[]}},P=function(d){var s=g(),n=s.find(function(t){return t.id===d});return n?n.graph:null},v=function(d){try{var s=g().map(function(n){return n.id!==d?n:!1}).filter(Boolean);localStorage.setItem(ee,JSON.stringify(s))}catch(n){console.log("[deleteLocalWorkflowFromId]",n)}},w=function(d,s){try{var n=g(),t=new Date().getTime();n.push({title:s||"Local-".concat(t),time:t,id:"kitchen-".concat(t,"-").concat(Math.floor(Math.random()*1e6)),graph:d}),localStorage.setItem(ee,JSON.stringify(n))}catch(r){console.log("[saveLocalWorkflow]",r)}},K=function(d,s){try{var n=g().map(function(t){return t.id!==d?t:N()(N()(N()({},t),s),{},{time:new Date().getTime()})});localStorage.setItem(ee,JSON.stringify(n))}catch(t){console.log("[updateLocalWorkflow]",t)}},O=function(){var _=i()(c()().mark(function d(s,n){var t,r;return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(p.prev=0,t=new FileReader,!s){p.next=9;break}return t.readAsText(s),p.next=6,new Promise(function(f,h){t.addEventListener("load",function(F){var k,j=(k=F.target)===null||k===void 0?void 0:k.result;typeof j=="string"?f(j):h(new Error("Failed to read file"))}),t.addEventListener("error",function(){h(new Error("Error reading file"))})});case 6:return r=p.sent,p.next=9,n(JSON.parse(r));case 9:p.next=14;break;case 11:p.prev=11,p.t0=p.catch(0),console.log("[readWorkflowFromFile]",p.t0);case 14:case"end":return p.stop()}},d,null,[[0,11]])}));return function(s,n){return _.apply(this,arguments)}}(),ne=function(d,s){var n=new Blob([JSON.stringify(d)],{type:"application/json"}),t=URL.createObjectURL(n),r=document.createElement("a");r.download=s?"".concat(s,".json"):"workflow.json",r.href=t,r.click(),URL.revokeObjectURL(t)},ie=function(d){return d!==null&&o()(d)==="object"&&"data"in d&&"connections"in d&&o()(d.data)==="object"&&Array.isArray(d.connections)},Y=["fixed","increment","decrement","randomize"],me=function(d,s){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(s==="Note")return{note:["STRING"]};var t=d[s];if(!t)return null;if(n)return t[n]||null;var r=t.input;return N()(N()({},r.required),r.optional)},be=function(d,s){var n=d.version,t=d.nodes,r=d.links;if(!(n&&t&&r))return d;if(!s)throw new Error("An active ComfyUI connection is required to convert a UI workflow file.");var a={},p=S()(t),f;try{for(p.s();!(f=p.n()).done;){var h=f.value;h.type==="PrimitiveNode"&&(a[h.id]=h.widgets_values[0])}}catch(Me){p.e(Me)}finally{p.f()}var F={},k=S()(t),j;try{for(k.s();!(j=k.n()).done;){var z=j.value,re=z.id,se=z.type;if(se!=="PrimitiveNode"){var Z={},ge=me(s,se);if(!ge)throw new Error("Workflow uses node type ".concat(se,", but it is not installed on the ComfyUI server."));for(var le=0,ae=0,De=Object.entries(ge);ae<De.length;ae++){var Re=C()(De[ae],2),Se=Re[0],ve=Re[1],Ae=ve[0];if(["INT","FLOAT","BOOL","BOOLEAN","STRING"].includes(Ae)||Array.isArray(Ae)){var Te=z.widgets_values;Z[Se]=Te[le],le+=1,Te.length>le&&Y.includes(Te[le])&&(le+=1)}var Ne=S()(z.inputs||[]),Fe;try{var Ge=function(){var We=Fe.value;if(We.name===Se&&We.link!==null||We.name===""&&Se==="*"){var Ue=r.find(function(Je){return Je[0]===We.link});if(Ue){var Be=a[Ue[1]];Be!==void 0?Z[Se]=Be:Z[Se]=[String(Ue[1]),Ue[2]]}return 1}};for(Ne.s();!(Fe=Ne.n()).done&&!Ge(););}catch(Me){Ne.e(Me)}finally{Ne.f()}}F[re]={class_type:se,inputs:Z}}}}catch(Me){k.e(Me)}finally{k.f()}return console.log("workflow",F),F},je=function(d,s){var n=d.version,t=d.nodes,r=d.links;if(!(n&&t&&r))return d;if(!s)throw new Error("An active ComfyUI connection is required to convert a UI workflow file.");var a=[],p=_createForOfIteratorHelper(t),f;try{for(p.s();!(f=p.n()).done;){var h=f.value,F=h.id,k=h.type;k!=="PrimitiveNode"&&(s[k]||a.push(k))}}catch(j){p.e(j)}finally{p.f()}return a}}}]);
