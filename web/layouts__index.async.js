"use strict";(self.webpackChunkgenerative_flow=self.webpackChunkgenerative_flow||[]).push([[717],{1362:function(qt,ge,o){o.r(ge),o.d(ge,{default:function(){return Yt}});var ne=o(3592),en=o(228),_=o.n(en),nn=o(7999),te=o.n(nn),tn=o(8305),T=o.n(tn),an=o(6068),R=o.n(an),on=o(3649),O=o.n(on),K=o(520),rn=o(2549),m=o(1263),e=o(1527),ve,sn=(0,m.kc)(function(t){var n=t.token,a=t.css;return a(ve||(ve=O()([`
    padding: 4px;

    .`,`-segmented-item {
      margin-right: 4px;
      color: `,`;
      border-radius: 5px;

      &:hover {
        color: `,`;
      }

      &:last-child {
        margin-right: 0;
      }
    }

    .`,`-segmented-item-selected {
      color: `,`;
      background-color: `,`;

      &:hover {
        color: `,`;
      }
    }

    .`,`-segmented-item-label {
      min-height: auto;
      padding: 7px 7px;
      line-height: unset;
    }
  `])),K.xb,n.colorTextTertiary,n.colorTextSecondary,K.xb,n.colorTextLightSolid,n.colorBgSpotlight,n.colorTextLightSolid,K.xb)}),ln=function(n){var a=sn(),r=a.styles,l=a.cx;return(0,e.jsx)(ne.i,{children:(0,e.jsx)(rn.Z,R()(R()({},n),{},{className:l(n.className,r)}))})},X=o(5910),fe=o(5874),Y=o(4848),F=o(1359),G=o(3957),cn=o(5401),xe=o(6310),s=o(959),q=o(8200),Ce=o(346),dn=function(n){var a=n.label,r=n.value;return(0,e.jsxs)("div",{children:[a,": ",r]})},ye=s.memo(dn),pn=function(n){var a=n.queue,r=n.onDeleteFromQueue;return a.length===0?[{label:"Empty queue",key:0}]:a.map(function(l,d){return{icon:d===0?(0,e.jsx)(xe.Z,{size:"small",indicator:(0,e.jsx)(fe.Z,{spin:!0})}):(0,e.jsx)(Ce.Z,{}),onClick:function(){return void r(l.id)},label:(0,e.jsxs)("div",{style:{marginLeft:8},children:[(0,e.jsxs)("h5",{children:["Queue ",l.id]}),(0,e.jsx)(ye,{label:"model",value:l.model===void 0?"N/A":l.model}),l.prompts.map(function(p,h){return(0,e.jsx)(ye,{label:"prompt",value:p},h)})]}),key:l.id}})},un=pn,Se=o(7049),mn=o(2122),hn=o(7154),gn=o(1954),H=o(7298),ea="https://gw.alipayobjects.com/zos/bmw-prod/9ecb2822-1592-4cb0-a087-ce0097fef2ca.svg",na="https://gw.alipayobjects.com/zos/bmw-prod/e146116d-c65a-4306-a3d2-bb8d05e1c49b.svg",vn=H.ZP.div.withConfig({componentId:"sc-19p43la-0"})(["display:flex;align-items:center;justify-content:space-between;height:46px;padding:16px 24px;background:",";border-bottom:1px solid ",";"],function(t){var n=t.theme;return n.colorBgContainer},function(t){var n=t.theme;return n.colorBorderSecondary}),de={auto:(0,e.jsx)("span",{role:"img",className:"anticon anticon-github",children:(0,e.jsx)("svg",{viewBox:"0 0 16 16",width:"1em",height:"1em",fill:"currentColor",children:(0,e.jsx)("path",{d:"M14.595 8a6.595 6.595 0 1 1-13.19 0 6.595 6.595 0 0 1 13.19 0ZM8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0Zm0 2.014v11.972A5.986 5.986 0 0 0 8 2.014Z"})})}),light:(0,e.jsx)("span",{role:"img",className:"anticon anticon-github",children:(0,e.jsx)("svg",{viewBox:"0 0 16 16",width:"1em",height:"1em",fill:"currentColor",children:(0,e.jsx)("path",{d:"M8 13a1 1 0 0 1 1 1v1a1 1 0 1 1-2 0v-1a1 1 0 0 1 1-1ZM8 3a1 1 0 0 1-1-1V1a1 1 0 1 1 2 0v1a1 1 0 0 1-1 1Zm7 4a1 1 0 1 1 0 2h-1a1 1 0 1 1 0-2h1ZM3 8a1 1 0 0 1-1 1H1a1 1 0 1 1 0-2h1a1 1 0 0 1 1 1Zm9.95 3.536.707.707a1 1 0 0 1-1.414 1.414l-.707-.707a1 1 0 0 1 1.414-1.414Zm-9.9-7.072-.707-.707a1 1 0 0 1 1.414-1.414l.707.707A1 1 0 0 1 3.05 4.464Zm9.9 0a1 1 0 0 1-1.414-1.414l.707-.707a1 1 0 0 1 1.414 1.414l-.707.707Zm-9.9 7.072a1 1 0 0 1 1.414 1.414l-.707.707a1 1 0 0 1-1.414-1.414l.707-.707ZM8 4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm0 6.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5Z"})})}),dark:(0,e.jsx)("span",{role:"img",className:"anticon anticon-github",children:(0,e.jsx)("svg",{viewBox:"0 0 16 16",width:"1em",height:"1em",fill:"currentColor",children:(0,e.jsx)("path",{d:"M8.218 1.455c3.527.109 6.327 3.018 6.327 6.545 0 3.6-2.945 6.545-6.545 6.545a6.562 6.562 0 0 1-6.036-4h.218c3.6 0 6.545-2.945 6.545-6.545 0-.91-.182-1.745-.509-2.545m0-1.455c-.473 0-.909.218-1.2.618-.29.4-.327.946-.145 1.382.254.655.4 1.31.4 2 0 2.8-2.291 5.09-5.091 5.09h-.218c-.473 0-.91.22-1.2.62-.291.4-.328.945-.146 1.38C1.891 14.074 4.764 16 8 16c4.4 0 8-3.6 8-8a7.972 7.972 0 0 0-7.745-8h-.037Z"})})})},ta=function(n){var a=n.onSetThemeMode;return[{icon:de.auto,label:"Auto",key:"auto",onClick:function(){return a("auto")}},{icon:de.light,label:"Light",key:"light",onClick:function(){return a("light")}},{icon:de.dark,label:"Dark",key:"dark",onClick:function(){return a("dark")}}]},se={default:(0,e.jsx)(Se.Z,{}),straight:(0,e.jsx)(mn.Z,{}),step:(0,e.jsx)(hn.Z,{}),smoothstep:(0,e.jsx)(gn.Z,{})},aa=function(n){var a=n.onEdgesType;return[{icon:se.default,label:"Bezier",key:"default",onClick:function(){return a("default")}},{icon:se.straight,label:"Straight",key:"straight",onClick:function(){return a("straight")}},{icon:se.step,label:"Step",key:"step",onClick:function(){return a("step")}},{icon:se.smoothstep,label:"SmoothStep",key:"smoothstep",onClick:function(){return a("smoothstep")}}]},be=o(7174),fn=o(1794),ee=o(3406),xn=o(5243),Cn=o(5792),yn=[{label:"Editor",value:"flow",icon:(0,e.jsx)(xn.Z,{})},{label:"Gallery",value:"gallery",icon:(0,e.jsx)(Cn.Z,{})}],Sn=function(n){var a=n.children,r=Y.ZP.useMessage(),l=T()(r,2),d=l[0],p=l[1],h=(0,s.useState)(0),y=T()(h,2),u=y[0],c=y[1],v=(0,s.useState)(!1),f=T()(v,2),x=f[0],g=f[1],i=(0,X.q)(function(B){return B},q.X),S=i.page,b=i.onSetPage,P=i.themeMode,D=i.onSetThemeMode,C=i.onSubmit,j=i.queue,N=i.onDeleteFromQueue,L=i.promptError,w=i.onEdgesAnimate,I=i.edgeType,Z=i.onEdgesType;(0,s.useEffect)(function(){L!==void 0&&d.open({type:"error",content:L,duration:4})},[L,u,d]),(0,s.useEffect)(function(){w(j.length>0)},[j,w]);var k=(0,s.useCallback)(function(){C(),c(function(B){return B+1})},[C]),M=(0,s.useCallback)(te()(_()().mark(function B(){var E,A,V,Q,W;return _()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.prev=0,E=X.q.getState(),A=(0,ee.Mg)(E),V=(0,fn.Fh)({graph:A,widgets:E.widgets,customWidgets:E.customWidgets,clientId:E.clientId}),Q=V.prompt,g(!0),z.next=8,be.Z.post("http://".concat("localhost:8188","/install_model"),{workflow:Q},{headers:{"Content-Type":"application/json"}});case 8:W=z.sent,g(!1),W.data.status===!0?Y.ZP.success("Models installed successfully"):Y.ZP.error("Error installing models: ".concat(W.data.models_not_found.join(", "))),z.next=18;break;case 13:z.prev=13,z.t0=z.catch(0),g(!1),console.error("Error installing models:",z.t0),Y.ZP.error("Failed to install models. Please try again later.");case 18:case"end":return z.stop()}},B,null,[[0,13]])})),[]),U=j.length>0;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(vn,{children:[(0,e.jsx)("div",{}),(0,e.jsx)(ln,{options:yn,value:S,size:"middle",onChange:b}),(0,e.jsxs)(F.Z,{children:[a,(0,e.jsx)(G.ZP,{type:"default",color:"default",variant:"solid",onClick:M,loading:x,children:"Install Missing Models"}),(0,e.jsx)(cn.Z.Button,{type:"primary",trigger:["hover"],placement:"bottomRight",onClick:k,menu:{items:un({queue:j,onDeleteFromQueue:N})},icon:U?(0,e.jsx)(xe.Z,{size:"small",indicator:(0,e.jsx)(fe.Z,{spin:!0,style:{color:"#fff"}})}):void 0,disabled:x,children:"Run Queue"})]})]}),p]})},bn=s.memo(Sn),jn=o(2092),ie=o.n(jn),kn=o(6909),Pn=o(2766),Dn=o(5018),wn=o(5994),En=o(2151),An=o(6958),je=o(3251),ke,Pe,De,we,Ee,Ae,Oe,Ie,Te,Re,Ne,Le,Me,Ze=(0,m.kc)(function(t,n){var a=t.token,r=(0,m.iv)(ke||(ke=O()([`
    position: relative;
    &::before {
      content: '';
      position: absolute;
      z-index: 50;
      transition: all 0.3s ease-in-out;
    }

    &:hover,
    &:active {
      &::before {
        background: `,`;
      }
    }
  `])),a.colorPrimary),l=(0,m.iv)(Pe||(Pe=O()([`
    cursor: pointer;

    position: absolute;
    z-index: 1001;

    color: `,`;

    opacity: 0;
    background: `,`;
    border-color: `,`;
    border-style: solid;
    border-width: 1px;
    border-radius: 4px;

    transition: opacity 0.1s;

    &:hover {
      color: `,`;
      background: `,`;
    }
  `])),a.colorTextTertiary,a.colorBgElevated,a.colorBorder,a.colorTextSecondary,a.colorFillQuaternary),d=17,p=40,h=16;return{container:(0,m.cx)(n,(0,m.iv)(De||(De=O()([`
        position: relative;
        flex-shrink: 0;
        border: 0 solid `,`;

        &:hover {
          .`,`-toggle {
            opacity: 1;
          }
        }
      `])),a.colorSplit,n)),toggleLeft:(0,m.cx)("".concat(n,"-toggle"),"".concat(n,"-toggle-left"),l,(0,m.iv)(we||(we=O()([`
        top: 50%;
        left: -`,`px;

        width: `,`px;
        height: `,`px;
        margin-top: -20px;

        border-right-width: 0;
        border-radius: 4px 0 0 4px;
      `])),d,h,p)),toggleRight:(0,m.cx)("".concat(n,"-toggle"),"".concat(n,"-toggle-right"),l,(0,m.iv)(Ee||(Ee=O()([`
        top: 50%;
        right: -`,`px;

        width: `,`px;
        height: `,`px;
        margin-top: -20px;

        border-left-width: 0;
        border-radius: 0 4px 4px 0;
      `])),d,h,p)),toggleTop:(0,m.cx)("".concat(n,"-toggle"),"".concat(n,"-toggle-top"),l,(0,m.iv)(Ae||(Ae=O()([`
        top: -`,`px;
        left: 50%;

        width: `,`px;
        height: `,`px;
        margin-left: -20px;

        border-bottom-width: 0;
        border-radius: 4px 4px 0 0;
      `])),d,p,h)),toggleBottom:(0,m.cx)("".concat(n,"-toggle"),"".concat(n,"-toggle-bottom"),l,(0,m.iv)(Oe||(Oe=O()([`
        bottom: -`,`px;
        left: 50%;

        width: `,`px;
        height: 16px;
        margin-left: -20px;

        border-top-width: 0;
        border-radius: 0 0 4px 4px;
      `])),d,p)),fixed:(0,m.cx)("".concat(n,"-fixed"),(0,m.iv)(Ie||(Ie=O()([`
        overflow: hidden;
        background: `,`;
      `])),a.colorBgContainer)),float:(0,m.cx)("".concat(n,"-float"),(0,m.iv)(Te||(Te=O()([`
        z-index: 2000;

        overflow: hidden;

        background: `,`;
        border-radius: 8px;
        box-shadow: `,`;
      `])),a.colorBgElevated,a.boxShadowSecondary)),leftHandle:(0,m.cx)((0,m.iv)(Re||(Re=O()([`
        `,`;

        &::before {
          left: 50%;
          width: 2px;
          height: 100%;
        }
      `])),r),"".concat(n,"-left-handle")),rightHandle:(0,m.cx)((0,m.iv)(Ne||(Ne=O()([`
        `,`;
        &::before {
          right: 50%;
          width: 2px;
          height: 100%;
        }
      `])),r),"".concat(n,"-right-handle")),topHandle:(0,m.cx)("".concat(n,"-top-handle"),(0,m.iv)(Le||(Le=O()([`
        `,`;

        &::before {
          top: 50%;
          width: 100%;
          height: 2px;
        }
      `])),r)),bottomHandle:(0,m.cx)("".concat(n,"-bottom-handle"),(0,m.iv)(Me||(Me=O()([`
        `,`;

        &::before {
          bottom: 50%;
          width: 100%;
          height: 2px;
        }
      `])),r))}}),On=150,In=400,pe=function(n){switch(n){case"bottom":return"top";case"top":return"bottom";case"right":return"left";case"left":return"right"}},Tn=(0,s.memo)(function(t){var n=t.children,a=t.placement,r=a===void 0?"right":a,l=t.resize,d=t.style,p=t.size,h=t.defaultSize,y=t.minWidth,u=t.minHeight,c=t.prefixCls,v=t.onSizeChange,f=t.onSizeDragging,x=t.expandable,g=x===void 0?!0:x,i=t.isExpand,S=t.onExpandChange,b=t.className,P=(0,K.k2)("draggable-panel",c),D=r==="top"||r==="bottom",C=Ze(P),j=C.styles,N=C.cx,L=(0,je.Z)(!0,{value:i,onChange:S}),w=T()(L,2),I=w[0],Z=w[1],k=l!==!1&&I,M=(0,s.useMemo)(function(){return k?ie()({},pe(r),j["".concat(pe(r),"Handle")]):{}},[k,r]),U=R()(ie()({top:!1,bottom:!1,right:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},pe(r),!0),l),B=(0,s.useMemo)(function(){return D?R()({width:"100%",height:On},h):R()({width:In,height:"100%"},h)},[D]),E=I?{minWidth:typeof y=="number"?Math.max(y,0):280,minHeight:typeof u=="number"?Math.max(u,0):void 0,defaultSize:B,size:p,style:d}:{minWidth:0,minHeight:0,size:{width:0,height:0}},A=(0,s.useMemo)(function(){switch(r){case"top":return{className:"Bottom",Arrow:kn.Z};case"bottom":return{className:"Top",Arrow:Pn.Z};case"right":return{className:"Left",Arrow:Dn.Z};case"left":return{className:"Right",Arrow:wn.Z}}},[j,r]),V=A.Arrow,Q=A.className;return(0,e.jsxs)("div",{className:N(j.container,b),style:ie()({},"border".concat(Q,"Width"),1),children:[g&&(0,e.jsx)(An.Z,{className:N(j["toggle".concat(Q)]),onClick:function(){Z(!I)},style:{opacity:I?void 0:1},children:(0,e.jsx)(V,{rotate:I?180:0})}),(0,e.jsx)(En.e,R()(R()({},E),{},{className:j.fixed,enable:k?U:void 0,handleClasses:M,onResizeStop:function(J,z,re,he){v==null||v(he,{width:re.style.width,height:re.style.height})},onResize:function(J,z,re,he){f==null||f(he,{width:re.style.width,height:re.style.height})},children:n}))]})}),Rn=o(4934),Nn=300,Ln=400,Mn=(0,s.memo)(function(t){var n=t.children,a=t.direction,r=t.resize,l=t.style,d=t.position,p=t.onPositionChange,h=t.size,y=t.defaultSize,u=t.defaultPosition,c=t.minWidth,v=c===void 0?280:c,f=t.minHeight,x=f===void 0?200:f,g=t.prefixCls,i=t.canResizing,S=Ze(g),b=S.styles,P=(0,s.useMemo)(function(){return i?{right:b.rightHandle,left:b.leftHandle,top:b.topHandle,bottom:b.bottomHandle}:{}},[i,a]),D=(0,s.useMemo)(function(){return i?r:R()({top:!0,bottom:!0,right:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},r)},[i,r]),C=R()({width:Ln,height:Nn},y),j=R()({x:100,y:100},u),N={minWidth:Math.max(v,0),minHeight:Math.max(x,0),defaultSize:C,size:h,style:l};return(0,e.jsx)(Rn.s,R()(R()({position:d,resizeHandleClasses:P,default:R()(R()({},j),C),onDragStop:function(w,I){p==null||p({x:I.x,y:I.y})},bound:"parent",enableResizing:D},N),{},{className:b.float,children:n}))}),Zn=(0,s.memo)(function(t){var n=t.children,a=t.className,r=t.mode,l=t.placement,d=l===void 0?"right":l,p=t.resize,h=t.style,y=t.position,u=t.onPositionChange,c=t.size,v=t.defaultSize,f=t.defaultPosition,x=t.minWidth,g=t.minHeight,i=t.prefixCls,S=t.onSizeChange,b=t.onSizeDragging,P=t.expandable,D=P===void 0?!0:P,C=t.isExpand,j=t.onExpandChange,N=(0,K.k2)("draggable-panel",i);switch(r){case"fixed":default:return(0,e.jsx)(Tn,{prefixCls:N,size:c,defaultSize:v,onSizeDragging:b,onSizeChange:S,minHeight:g,minWidth:x,resize:p,onExpandChange:j,expandable:D,isExpand:C,className:a,placement:d,style:h,children:n});case"float":return(0,e.jsx)(Mn,{prefixCls:N,defaultPosition:f,position:y,onPositionChange:u,minHeight:g,minWidth:x,defaultSize:v,size:c,onSizeDragging:b,onSizeChange:S,resize:p,canResizing:p!==!1,className:a,style:h,children:n})}}),ze=o(5955),zn=o(385),Wn=o(7911),Hn=o(2655),ae=o(1074),We=o(4412),le=o(1534),_n=H.ZP.div.withConfig({componentId:"sc-1i4gfeb-0"})(["height:100%;display:flex;flex-direction:column;padding:0px;"]),Fn=H.ZP.div.withConfig({componentId:"sc-1i4gfeb-1"})(["display:flex;flex-direction:column;flex:1;overflow-y:auto;margin-bottom:16px;"]),Un=H.ZP.div.withConfig({componentId:"sc-1i4gfeb-2"})(["background-color:",";align-self:",";padding:8px 10px;border-radius:8px;max-width:70%;word-break:break-word;display:flex;flex-direction:column;"],function(t){return t.$sender==="user"?"#e6f7ff":"#f0f0f0"},function(t){return t.$sender==="user"?"flex-end":"flex-start"}),Bn=H.ZP.div.withConfig({componentId:"sc-1i4gfeb-3"})(["font-size:0.8em;color:#666;margin-top:4px;cursor:pointer;transition:color 0.3s ease;&:hover{color:#1890ff;}"]),Vn=function(){var n=(0,ze.S)(),a=(0,X.q)(function(D){return D},q.X),r=a.messages,l=a.onAddMessage,d=(0,s.useRef)(null),p=(0,s.useState)(""),h=T()(p,2),y=h[0],u=h[1],c=Y.ZP.useMessage(),v=T()(c,2),f=v[0],x=v[1],g=(0,X.q)(function(D){return D},q.X),i=g.onLoadWorkflow,S=function(){var C;(C=d.current)===null||C===void 0||C.scrollIntoView({behavior:"smooth"})};(0,s.useEffect)(function(){S()},[r]);var b=(0,s.useCallback)(function(){var D=te()(_()().mark(function C(j){return _()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,i(j);case 2:f.success("Success! Workflow have been loaded.");case 3:case"end":return L.stop()}},C)}));return function(C){return D.apply(this,arguments)}}(),[f]),P=(0,s.useCallback)(te()(_()().mark(function D(){var C,j,N,L,w,I;return _()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(y.trim()){k.next=2;break}return k.abrupt("return");case 2:return C={content:[{text:y}],sender:"user"},l(C),u(""),k.prev=5,k.next=8,be.Z.post("http://localhost:8000/completion",{query:y});case 8:j=k.sent,N=j.data,N.num>0?L=N.data.map(function(M){return{text:M.description,name:M.name,metadata:M.metadata}}):L=[{text:"No workflow found."}],w={content:L,sender:"bot"},l(w),k.next=20;break;case 15:k.prev=15,k.t0=k.catch(5),console.error("Error sending message:",k.t0),I={content:[{text:"Failed to get a response from the server."}],sender:"bot"},l(I);case 20:case"end":return k.stop()}},D,null,[[5,15]])})),[y]);return(0,e.jsxs)(e.Fragment,{children:[x,(0,e.jsxs)(_n,{children:[(0,e.jsxs)(Fn,{children:[(0,e.jsx)(ae.Z,{dataSource:r,renderItem:function(C){return(0,e.jsxs)(ae.Z.Item,{style:{display:"flex",justifyContent:C.sender==="user"?"flex-end":"flex-start",alignItems:"flex-start",border:"none",width:"100%",padding:"4px",gap:"8px",maxWidth:"100%"},children:[C.sender==="bot"&&(0,e.jsx)(zn.Z,{style:{color:"#1890ff"}}),(0,e.jsx)(Un,{$sender:C.sender,children:C.content.map(function(j,N){return(0,e.jsxs)("div",{children:[j.name&&(0,e.jsx)("h3",{children:j.name}),j.text,j.metadata&&(0,e.jsx)(We.Z,{title:"Click to import",placement:"right",children:(0,e.jsxs)(Bn,{onClick:function(){return b(j.metadata)},children:[(0,e.jsx)(Wn.Z,{style:{marginRight:4}}),j.name]})})]},"content-".concat(N))})})]})}}),(0,e.jsx)("div",{ref:d})]}),(0,e.jsxs)(F.Z.Compact,{style:{width:"100%"},children:[(0,e.jsx)(le.Z,{placeholder:"What type of workflow are you looking for?",value:y,onPressEnter:P,onChange:function(C){return u(C.target.value)}}),(0,e.jsx)(G.ZP,{icon:(0,e.jsx)(Hn.Z,{}),type:"primary",onClick:P,children:"Send"})]})]})]})},Gn=s.memo(Vn),$n=o(335),Qn=o.n($n),Kn=o(1686),Xn=o(6952),ue=o(1012),oe=o(262),Jn=H.ZP.div.withConfig({componentId:"sc-1mc9338-0"})(["margin-top:6px;background:",";"],function(t){var n=t.isRequired,a=t.theme;return n?a.colorPrimary:a.colorBorder}),Yn=function(n){var a=n.data,r=(0,s.useMemo)(function(){return a.output.map(function(u){return{name:u,type:u}})},[a.output]),l=(0,s.useMemo)(function(){var u=[],c=[];return Object.entries(a.input.required).forEach(function(v){var f=T()(v,2),x=f[0],g=f[1];Xn.l.isParameterOrList(g)?u.push({name:x,type:g[0],input:g}):c.push({name:x,type:g[0]})}),[u,c]},[a.input.required]),d=T()(l,2),p=d[0],h=d[1],y=(0,s.useCallback)(function(u){var c=u.item,v=u.position,f=u.isRequired;return(0,e.jsxs)("h5",{children:[(0,e.jsx)(Jn,{className:"react-flow__handle",style:ie()({},v,-3),isRequired:f}),(0,ue.Z)(c.name)]})},[]);return(0,e.jsxs)(oe.OE,{size:"small",title:a.name,active:0,style:{minWidth:240},children:[(0,e.jsxs)(oe.VA,{children:[(0,e.jsx)(oe.zw,{children:h.map(function(u,c){return(0,e.jsx)(y,{item:u,position:"left",isRequired:1},c)})}),(0,e.jsx)(oe.zw,{style:{textAlign:"right"},children:r.map(function(u,c){return(0,e.jsx)(y,{item:u,position:"right",isRequired:1},c)})})]}),(0,e.jsx)(oe.zw,{children:p.map(function(u,c){return(0,e.jsx)(y,{item:u,position:"left",isRequired:0},c)})})]})},He=s.memo(Yn),qn=o(2337),et=o(8865),me=o(9629),_e,Fe,Ue,Be,nt=(0,m.kc)(function(t,n){var a=t.token,r=t.stylish,l=n.prefixCls,d=n.className,p=n.showPanel;return{container:(0,m.cx)(l,d,p?(0,m.iv)(_e||(_e=O()([`
            margin-bottom: 8px;
            padding: 6px 8px 12px 8px;
            background: `,`;
            border-radius: 4px;
          `])),a.colorFillQuaternary):""),header:(0,m.cx)(p?"".concat(l,"-expand"):"".concat(l,"-collapsed"),p?"":(0,m.iv)(Fe||(Fe=O()([`
            user-select: none;
            padding: 6px 8px;
            border-radius: 4px;
            `,`
          `])),r.containerBgL2)),title:(0,m.cx)((0,m.iv)(Ue||(Ue=O()([`
        height: 24px;
      `]))),p?(0,m.iv)(Be||(Be=O()([`
            user-select: none;
            margin-left: -4px;
            padding: 4px;
            border-radius: 4px;

            `,`
          `])),r.containerBgHover):"")}}),tt=function(n){var a=n.defaultExpand,r=a===void 0?!1:a,l=n.expand,d=n.onExpandChange,p=n.prefixCls,h=n.title,y=n.children,u=n.className,c=n.extra,v=(0,K.k2)("collapse-title",p),f=(0,je.Z)(r,{value:l,onChange:d}),x=T()(f,2),g=x[0],i=x[1],S=function(){i(!g)},b=nt({showPanel:g,prefixCls:v,className:u}),P=b.styles;return(0,e.jsx)(ne.i,{children:(0,e.jsxs)(me.D,{className:P.container,children:[(0,e.jsxs)(me.D,{direction:"horizontal",distribution:"space-between",align:"center",className:P.header,onClick:g?void 0:S,children:[(0,e.jsxs)(me.D,{direction:"horizontal",gap:4,align:"center",onClick:g?S:void 0,className:P.title,children:[(0,e.jsx)(qn.Z,{style:{fontSize:10},rotate:g?90:0}),(0,e.jsx)("div",{children:h})]}),c&&c(g)]}),g?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(et.Z,{style:{margin:"4px 0 12px"},dashed:!0}),y]}):null]})})},at=tt,ot=o(3483),rt="8px 4px",st=H.ZP.div.withConfig({componentId:"sc-fv8tvn-0"})(["cursor:pointer;padding:",";"],rt),it=function(n){var a=n.cat,r=n.data,l=n.onAddNode,d=n.globalExpand,p=n.cardView,h=(0,s.useState)(!0),y=T()(h,2),u=y[0],c=y[1];(0,s.useEffect)(function(){c(d)},[d]);var v=(0,s.useCallback)(function(i,S){i.dataTransfer.setData("application/reactflow",JSON.stringify(S)),i.dataTransfer.effectAllowed="move"},[]),f=(0,s.useCallback)(function(){return(0,e.jsx)("div",{children:r.map(function(i){return(0,e.jsx)(st,{draggable:!0,onDragStart:function(b){return v(b,i)},onClick:function(){return l({widget:i})},children:(0,e.jsx)(He,{data:i})},i.name)})})},[r,v,l]),x=(0,s.useCallback)(function(){return(0,e.jsx)(F.Z,{wrap:!0,align:"baseline",children:r.map(function(i){return(0,e.jsx)(ot.Z,{content:(0,e.jsx)(He,{data:i}),placement:"left",overlayStyle:{pointerEvents:"none"},destroyTooltipOnHide:!0,children:(0,e.jsx)(G.ZP,{onClick:function(){return l({widget:i})},draggable:!0,onDragStart:function(b){return v(b,i)},children:(0,ue.Z)(i.name)})},i.name)})})},[r,v,l]),g=(0,s.useCallback)(function(i){c(i)},[]);return(0,e.jsx)(at,{title:(0,ue.Z)(a),expand:u,onExpandChange:g,children:p?f():x()},a)},lt=s.memo(it),Ve=H.ZP.div.withConfig({componentId:"sc-e793qc-0"})(["display:flex;flex-direction:column;align-items:center;gap:8px;margin-bottom:8px;"]),Ge=H.ZP.div.withConfig({componentId:"sc-e793qc-1"})(["overflow:auto;flex:1;"]),oa=le.Z.Search,ct=function(){var n=(0,X.q)(function(w){return w},q.X),a=n.widgets,r=n.onAddNode,l=(0,s.useState)({}),d=T()(l,2),p=d[0],h=d[1],y=(0,s.useState)(""),u=T()(y,2),c=u[0],v=u[1],f=(0,s.useState)(!0),x=T()(f,2),g=x[0],i=x[1],S=(0,s.useState)(!1),b=T()(S,2),P=b[0],D=b[1];(0,s.useEffect)(function(){var w={},I=Object.values(a);c&&(I=I.filter(function(U){return U.name.toLowerCase().includes(c.toLowerCase())}));var Z=Qn()(I),k;try{for(Z.s();!(k=Z.n()).done;){var M=k.value;w[M.category]?w[M.category].push(M):w[M.category]=[M]}}catch(U){Z.e(U)}finally{Z.f()}h(w)},[a,c]);var C=(0,s.useCallback)(function(w){v(w.target.value)},[]),j=(0,s.useCallback)(function(){D(function(w){return!w})},[]),N=(0,s.useCallback)(function(){i(!0)},[]),L=(0,s.useCallback)(function(){i(!1)},[]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ve,{children:(0,e.jsx)(le.Z,{addonBefore:(0,e.jsx)(Kn.Z,{}),placeholder:"Input search text",onChange:C,style:{width:"100%"}})}),(0,e.jsx)(Ge,{children:Object.entries(p).map(function(w){var I=T()(w,2),Z=I[0],k=I[1];return(0,e.jsx)(lt,{data:k,cat:Z,onAddNode:r,globalExpand:g,cardView:P},Z)})})]})},dt=s.memo(ct),pt=o(858),$e=o(3603),ut=o(1203),Qe=o(4566),mt=o(4322),ht=o(4194),gt=o(6597),vt=o(4434),ft=o(7825),xt=o.n(ft),Ke,Xe,Je,Ct=(0,m.kc)(function(t,n){var a=t.token,r=n.size,l=n.className,d=n.prefixCls,p=typeof r=="number"?(0,m.iv)(Ke||(Ke=O()([`
          width: `,`px !important;
          height: `,`px !important;
        `])),r,r):"",h=(0,m.iv)(Xe||(Xe=O()([`
    display: flex;
    align-items: center;
    justify-content: center;

    &:hover {
      color: `,` !important;
    }
  `])),a.colorText);return{container:(0,m.cx)(d,h,p,l),tooltip:(0,m.iv)(Je||(Je=O()([`
      pointer-events: none;
    `])))}}),yt=["placement","title","icon","cursor","onClick","className","size","prefixCls"],St=function(n){var a=n.placement,r=n.title,l=n.icon,d=n.cursor,p=n.onClick,h=n.className,y=n.size,u=n.prefixCls,c=xt()(n,yt),v=(0,K.k2)("actionicon",u),f=Ct({size:y,prefixCls:v}),x=f.styles,g=(0,ze.S)(),i=(0,e.jsx)(G.ZP,R()(R()({icon:l,className:(0,m.cx)(h,x.container),type:"text",style:{cursor:d},size:"small"},c),{},{onClick:p}));return(0,e.jsx)(ne.i,{componentToken:{Button:{colorText:g.colorTextTertiary,colorBgTextHover:g.colorFillSecondary,colorBgTextActive:g.colorFill}},children:r?(0,e.jsx)(We.Z,{showArrow:!1,align:{offset:[0,-5]},overlayClassName:x.tooltip,title:r,placement:a,children:i}):i})},bt=St,ce=bt,jt=o(5135),kt=o(9422),Pt=o(6668),Dt=o(6142),wt=o(1915),Et=o(6483),At=o.n(Et),Ot=function(n){var a=n.item,r=n.index,l=n.handleRename,d=n.handleUpdate,p=n.handleDelete,h=n.handleLoad,y=(0,s.useState)(!1),u=T()(y,2),c=u[0],v=u[1],f=(0,s.useCallback)(function(D){v(!1);var C=D.target.value;C&&l(a.id,C)},[l,a.id]),x=(0,s.useCallback)(function(){h(a.graph,a.title)},[h,a.graph,a.title]),g=(0,s.useCallback)(function(){v(!0)},[]),i=(0,s.useCallback)(function(){d(a.id,a.title)},[d,a.id,a.title]),S=(0,s.useCallback)(function(){(0,ee.Cq)(a.graph,a.title)},[a.graph,a.title]),b=(0,s.useCallback)(function(){p(a.id,a.title)},[p,a.id,a.title]),P=(0,s.useCallback)(function(){return c?(0,e.jsx)(vt.I,{defaultValue:a.title,onBlur:f,onPressEnter:f}):(0,e.jsxs)("a",{title:"Load",onClick:x,children:[a.title,r===0&&(0,e.jsx)(Dt.Z,{color:"blue",style:{marginLeft:4},children:"Recent"})]})},[c,a.title,r,f,x]);return(0,e.jsx)(ae.Z.Item,{extra:(0,e.jsxs)(F.Z.Compact,{children:[(0,e.jsx)(ce,{title:"Rename",icon:(0,e.jsx)(jt.Z,{}),onClick:g}),(0,e.jsx)(ce,{title:"Update",icon:(0,e.jsx)($e.Z,{}),onClick:i}),(0,e.jsx)(ce,{title:"Download",icon:(0,e.jsx)(Qe.Z,{}),onClick:S}),(0,e.jsx)(ce,{title:"Delete",icon:(0,e.jsx)(Ce.Z,{}),onClick:b})]}),children:(0,e.jsx)(ae.Z.Item.Meta,{avatar:(0,e.jsx)("a",{title:"Load",onClick:x,children:(0,e.jsx)(wt.C,{size:44,shape:"square",children:a.title[0].toUpperCase()})}),title:P(),description:(0,e.jsxs)(F.Z,{size:10,align:"center",children:[(0,e.jsxs)(F.Z,{size:4,align:"center",children:[(0,e.jsx)(kt.Z,{}),Object.keys(a.graph.data).length]}),(0,e.jsxs)(F.Z,{size:4,align:"center",children:[(0,e.jsx)(Se.Z,{}),a.graph.connections.length]}),(0,e.jsxs)(F.Z,{size:4,align:"center",children:[(0,e.jsx)(Pt.Z,{}),At()(a.time).format("YYYY-MM-DD HH:mm:ss")]})]})})},a.id)},It=s.memo(Ot),Tt=function(){var n=Y.ZP.useMessage(),a=T()(n,2),r=a[0],l=a[1],d=(0,s.useState)(),p=T()(d,2),h=p[0],y=p[1],u=(0,s.useState)(),c=T()(u,2),v=c[0],f=c[1],x=(0,s.useState)(0),g=T()(x,2),i=g[0],S=g[1],b=(0,X.q)(function(E){return E},q.X),P=b.onLoadWorkflow,D=b.onDownloadWorkflow,C=b.onSaveLocalWorkFlow,j=b.onUpdateLocalWorkFlowGraph,N=b.onUpdateLocalWorkFlowTitle,L=(0,s.useCallback)(function(){C(h),S(i+1),r.success("Success! ".concat(h!=null?h:"Your workflow"," have been saved."))},[i,r,C,h]),w=(0,s.useCallback)(function(E,A){(0,ee.Sf)(E),S(i+1),r.info("".concat(A," has been deleted."))},[i,r]),I=(0,s.useCallback)(function(){var E=te()(_()().mark(function A(V,Q){return _()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return console.log("before onLoadWorkflow"),J.next=3,P(V);case 3:console.log("after onLoadWorkflow"),S(i+1),r.success("Success! ".concat(Q," have been loaded."));case 6:case"end":return J.stop()}},A)}));return function(A,V){return E.apply(this,arguments)}}(),[i,r,P]),Z=(0,s.useCallback)(function(){var E=te()(_()().mark(function A(V){return _()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return console.log("before onLoadWorkflow"),W.next=3,(0,ee.Sk)(V,P);case 3:console.log("after onLoadWorkflow"),S(i+1),r.success("Success! the workflow have been loaded.");case 6:case"end":return W.stop()}},A)}));return function(A){return E.apply(this,arguments)}}(),[i,r,P]),k=(0,s.useCallback)(function(E,A){j(E),S(i+1),r.success("Success! ".concat(A," have been update."))},[i,r,j]),M=(0,s.useCallback)(function(E,A){N(E,A),S(i+1),r.success("Success! the workflow have been renamed to ".concat(A," ."))},[i,r,N]),U=(0,s.useCallback)(function(){(0,ee.W)(),P(pt.Z),S(i+1),r.success("Success! load default workflow.")},[i,r,P]);(0,s.useEffect)(function(){f((0,ee.qW)().sort(function(E,A){return A.time-E.time}))},[i]);var B=(0,s.useCallback)(function(E,A){return(0,e.jsx)(It,{item:E,index:A,handleLoad:I,handleUpdate:k,handleDelete:w,handleRename:M})},[w,I,M,k]);return(0,e.jsxs)(e.Fragment,{children:[l,(0,e.jsxs)(Ve,{children:[(0,e.jsxs)(F.Z.Compact,{style:{width:"98%"},children:[(0,e.jsx)(le.Z,{placeholder:"Name the workflow to save",onChange:function(A){return y(A.target.value)}}),(0,e.jsx)(G.ZP,{icon:(0,e.jsx)($e.Z,{}),type:"primary",onClick:L,children:"Save"})]}),(0,e.jsxs)(F.Z.Compact,{block:!0,style:{marginLeft:8,gap:4},children:[(0,e.jsx)(G.ZP,{style:{width:"33%"},type:"primary",title:"New",icon:(0,e.jsx)(ut.Z,{}),onClick:U,children:"New"}),(0,e.jsx)(G.ZP,{style:{width:"33%"},type:"primary",title:"Download",icon:(0,e.jsx)(Qe.Z,{}),onClick:D,children:"Download"}),(0,e.jsx)(ht.Z,{accept:".json",maxCount:1,itemRender:function(){return null},beforeUpload:Z,children:(0,e.jsx)(G.ZP,{style:{width:"145%"},type:"primary",title:"Upload",icon:(0,e.jsx)(mt.Z,{}),children:"Upload"})})]})]}),(0,e.jsxs)(Ge,{children:[(0,e.jsx)("h5",{children:"Saved Workflows"}),(v==null?void 0:v.length)===0?(0,e.jsx)(gt.Z,{style:{marginTop:"40vh"},image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",description:"Nothing here yet!"}):(0,e.jsx)(ae.Z,{dataSource:v,renderItem:B})]})]})},Rt=s.memo(Tt),Nt=o(5928),Ye,Lt=(0,m.kc)(function(t){var n=t.token,a=t.prefixCls,r=t.css,l=t.stylish,d=".".concat(a,"-tabs");return{cls:r(Ye||(Ye=O()([`
      position: relative;

      display: flex;
      flex: 1;
      flex-direction: column;

      max-height: 100%;

      `,"-tab + ",`-tab {
        margin: 8px 4px !important;
        padding: 0 12px !important;
      }

      `,`-tab {
        color: `,`;
        transition: background-color 150ms ease-out;

        &:first-child {
          margin: 8px 4px 8px 0;
          padding: 4px 12px !important;
        }

        &:hover {
          color: `,` !important;
          background: `,`;
          border-radius: 4px;
        }
      }

      `,`-nav {
        position: relative;
        z-index: 10;

        flex: none;

        width: 100%;
        height: 46px;
        margin: 0;
        padding: 0 12px;

        `,`;
      }

      `,`-content {
        height: 100%;
      }

      `,`-tabpane-active {
        display: flex;
        flex-direction: column;
        height: 100%;
      }

      `,`-content-holder {
        overflow-y: auto;
        flex: 1;
        padding: 8px 12px;
      }
    `])),d,d,d,n.colorTextSecondary,n.colorText,n.colorFillTertiary,d,l.backgroundBlur,d,d,d)}}),Mt=function(n){var a=Lt(),r=a.styles,l=a.cx;return(0,e.jsx)(ne.i,{children:(0,e.jsx)(Nt.Z,R()(R()({},n),{},{className:l(n.className,r.cls)}))})},$=function(t){return t.NODES="Nodes",t.WORKFLOW="Workflows",t.CHATBOT="Flow Pilot",t}($||{}),Zt=H.ZP.div.withConfig({componentId:"sc-2jub1t-0"})(["display:flex;flex-direction:column;height:100%;"]),zt=function(){var n=(0,s.useMemo)(function(){return[{label:$.CHATBOT,key:$.CHATBOT,children:(0,e.jsx)(Gn,{})},{label:$.NODES,key:$.NODES,children:(0,e.jsx)(dt,{})},{label:$.WORKFLOW,key:$.WORKFLOW,children:(0,e.jsx)(Rt,{})}]},[]);return(0,e.jsx)(Zt,{children:(0,e.jsx)(Mt,{defaultActiveKey:$.CHATBOT,items:n})})},Wt=s.memo(zt),Ht=o(8775),ra=o(8316),_t=o(5791),Ft=o(8314),qe,Ut=(0,m.vJ)(qe||(qe=O()([`
  body {
    color: `,`;
    background: `,`;
  }

  div {
    user-select: none;
  }

  code,.react-json-view {
    font-family: 'Hack', 'IBM Plex Mono', 'ui-monospace', 'Consolas', monospace !important;
  }

  .react-flow__node[type="Group"] {
    pointer-events: none !important;
    z-index: -1 !important;
  }

  .react-flow__handle {
    width: 8px;
    height: 8px;
    border-radius: 4px;
  }

  .ant-card[type="Reroute"] .react-flow__handle {
    margin-top: 0;
  }


  .react-json-view {
    background: transparent !important;
  }

    /* width */
  ::-webkit-scrollbar {
    width: 6px;
  }

  /* Track */
  ::-webkit-scrollbar-track {
    border-radius: 10px;
  }

  /* Handle */
  ::-webkit-scrollbar-thumb {
    background: `,`;
    border-radius: 10px;
  }

  /* Handle on hover */
  ::-webkit-scrollbar-thumb:hover {
    background:  `,`;
  }




  .react-flow__handle-connecting {
    background: `,` !important;
  }

  .react-flow__handle-valid {
    background: `,` !important;
  }

  .react-flow__minimap-mask {
    fill: `,`;
  }

  .react-flow__minimap {
    overflow: hidden;

    height: 150px;

    background: `,`;
    /* backdrop-filter: blur(24px); */
    border: 1px solid `,`;
    border-radius: 4px;
    box-shadow: `,`;
  }

  .react-flow__minimap-node {
    opacity: .5;
  }

  .react-flow__attribution {
    display: none;
  }

  .react-flow__controls {
    border: 1px solid `,`;
    box-shadow: `,`;

    button {
      color: `,`;
      background-color: `,`;
      border-bottom: none;
      path {
        fill: currentColor;
      }
    }

    button + button {
      border-top: 1px solid `,`;
    }

    button:hover {
      background-color: `,`;
    }
  }
`])),function(t){var n=t.theme;return n.colorTextBase},function(t){var n=t.theme;return n.colorBgBase},function(t){var n=t.theme;return n.colorBorderSecondary},function(t){var n=t.theme;return n.colorBorder},function(t){var n=t.theme;return n.colorError},function(t){var n=t.theme;return n.colorSuccess},function(t){var n=t.theme;return n.colorBgMask},function(t){var n=t.theme;return(0,Ft.m4)(n.colorBgContainer,.8)},function(t){var n=t.theme;return n.colorBorderSecondary},function(t){var n=t.theme;return n.boxShadowTertiary},function(t){var n=t.theme;return n.colorBorder},function(t){var n=t.theme;return n.boxShadow},function(t){var n=t.theme;return n.colorTextBase},function(t){var n=t.theme;return n.colorBgElevated},function(t){var n=t.theme;return n.colorBorder},function(t){var n=t.theme;return n.colorBgSpotlight}),Bt=Ut,Vt=o(1326),Gt=o(4456),$t="ws://".concat(Vt.Z.host,"/ws"),Qt=function(){var n=(0,X.q)(function(u){var c;return R()(R()({},u),{},{nodeIdInProgress:(c=u.nodeInProgress)===null||c===void 0?void 0:c.id})},q.X),a=n.clientId,r=n.nodeIdInProgress,l=n.onNewClientId,d=n.onQueueUpdate,p=n.onNodeInProgress,h=n.onImageSave,y=(0,s.useCallback)(function(u){var c=JSON.parse(u.data),v={status:function(){c.data.sid!==void 0&&c.data.sid!==a&&l(c.data.sid),d()},executing:function(){c.data.node!==void 0?p(c.data.node,0):r!==void 0&&p(r,0)},progress:function(){r!==void 0&&p(r,c.data.value/c.data.max)},executed:function(){var i=c.data.output.images;Array.isArray(i)&&h(c.data.node,i)}},f=c.type,x=v[f];x&&x()},[a,r,l,d,p,h]);return(0,Gt.useWebSocket)($t,{onMessage:y,shouldReconnect:function(c){return!0},reconnectAttempts:10,reconnectInterval:5e3}),null},Kt=s.memo(Qt),Xt=H.ZP.div.withConfig({componentId:"sc-1k2gi0p-0"})(["display:flex;width:100vw;height:100vh;"]),Jt=function(){return(0,e.jsxs)(ne.i,{children:[(0,e.jsxs)(Xt,{children:[(0,e.jsxs)(Ht.Z,{children:[(0,e.jsx)(bn,{}),(0,e.jsx)(_t.j3,{})]}),(0,e.jsx)(Zn,{children:(0,e.jsx)(Wt,{})})]}),(0,e.jsx)(Bt,{}),(0,e.jsx)(Kt,{})]})},Yt=Jt}}]);
