"use strict";(self.webpackChunkgenerative_flow=self.webpackChunkgenerative_flow||[]).push([[717],{1362:function(ta,ge,o){o.r(ge),o.d(ge,{default:function(){return na}});var ne=o(3592),en=o(228),U=o.n(en),nn=o(7999),te=o.n(nn),tn=o(8305),T=o.n(tn),an=o(6068),R=o.n(an),on=o(3649),O=o.n(on),K=o(520),rn=o(2549),h=o(1263),e=o(1527),ve,sn=(0,h.kc)(function(t){var n=t.token,a=t.css;return a(ve||(ve=O()([`
    padding: 4px;

    .`,`-segmented-item {
      margin-right: 4px;
      color: `,`;
      border-radius: 2px;

      &:hover {
        color: `,`;
      }

      &:last-child {
        margin-right: 0;
      }
    }

    .`,`-segmented-item-selected {
      color: `,`;

      &:hover {
        color: `,`;
      }
    }

    .`,`-segmented-item-label {
      min-height: auto;
      padding: 2px 7px;
      line-height: unset;
    }
  `])),K.xb,n.colorTextTertiary,n.colorTextSecondary,K.xb,n.colorText,n.colorText,K.xb)}),ln=function(n){var a=sn(),r=a.styles,l=a.cx;return(0,e.jsx)(ne.i,{children:(0,e.jsx)(rn.Z,R()(R()({},n),{},{className:l(n.className,r)}))})},X=o(5910),fe=o(5874),Y=o(4848),F=o(1359),xe=o(5401),z=o(3957),Ce=o(6310),s=o(959),q=o(8200),ye=o(346),cn=function(n){var a=n.label,r=n.value;return(0,e.jsxs)("div",{children:[a,": ",r]})},Se=s.memo(cn),dn=function(n){var a=n.queue,r=n.onDeleteFromQueue;return a.length===0?[{label:"Empty queue",key:0}]:a.map(function(l,d){return{icon:d===0?(0,e.jsx)(Ce.Z,{size:"small",indicator:(0,e.jsx)(fe.Z,{spin:!0})}):(0,e.jsx)(ye.Z,{}),onClick:function(){return void r(l.id)},label:(0,e.jsxs)("div",{style:{marginLeft:8},children:[(0,e.jsxs)("h5",{children:["Queue ",l.id]}),(0,e.jsx)(Se,{label:"model",value:l.model===void 0?"N/A":l.model}),l.prompts.map(function(p,m){return(0,e.jsx)(Se,{label:"prompt",value:p},m)})]}),key:l.id}})},pn=dn,be=o(7049),un=o(2122),mn=o(7154),hn=o(1954),_=o(7298),aa="https://gw.alipayobjects.com/zos/bmw-prod/9ecb2822-1592-4cb0-a087-ce0097fef2ca.svg",oa="https://gw.alipayobjects.com/zos/bmw-prod/e146116d-c65a-4306-a3d2-bb8d05e1c49b.svg",gn=_.ZP.div.withConfig({componentId:"sc-19p43la-0"})(["display:flex;align-items:center;justify-content:space-between;height:46px;padding:16px 24px;background:",";border-bottom:1px solid ",";"],function(t){var n=t.theme;return n.colorBgContainer},function(t){var n=t.theme;return n.colorBorderSecondary}),se={auto:(0,e.jsx)("span",{role:"img",className:"anticon anticon-github",children:(0,e.jsx)("svg",{viewBox:"0 0 16 16",width:"1em",height:"1em",fill:"currentColor",children:(0,e.jsx)("path",{d:"M14.595 8a6.595 6.595 0 1 1-13.19 0 6.595 6.595 0 0 1 13.19 0ZM8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0Zm0 2.014v11.972A5.986 5.986 0 0 0 8 2.014Z"})})}),light:(0,e.jsx)("span",{role:"img",className:"anticon anticon-github",children:(0,e.jsx)("svg",{viewBox:"0 0 16 16",width:"1em",height:"1em",fill:"currentColor",children:(0,e.jsx)("path",{d:"M8 13a1 1 0 0 1 1 1v1a1 1 0 1 1-2 0v-1a1 1 0 0 1 1-1ZM8 3a1 1 0 0 1-1-1V1a1 1 0 1 1 2 0v1a1 1 0 0 1-1 1Zm7 4a1 1 0 1 1 0 2h-1a1 1 0 1 1 0-2h1ZM3 8a1 1 0 0 1-1 1H1a1 1 0 1 1 0-2h1a1 1 0 0 1 1 1Zm9.95 3.536.707.707a1 1 0 0 1-1.414 1.414l-.707-.707a1 1 0 0 1 1.414-1.414Zm-9.9-7.072-.707-.707a1 1 0 0 1 1.414-1.414l.707.707A1 1 0 0 1 3.05 4.464Zm9.9 0a1 1 0 0 1-1.414-1.414l.707-.707a1 1 0 0 1 1.414 1.414l-.707.707Zm-9.9 7.072a1 1 0 0 1 1.414 1.414l-.707.707a1 1 0 0 1-1.414-1.414l.707-.707ZM8 4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm0 6.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5Z"})})}),dark:(0,e.jsx)("span",{role:"img",className:"anticon anticon-github",children:(0,e.jsx)("svg",{viewBox:"0 0 16 16",width:"1em",height:"1em",fill:"currentColor",children:(0,e.jsx)("path",{d:"M8.218 1.455c3.527.109 6.327 3.018 6.327 6.545 0 3.6-2.945 6.545-6.545 6.545a6.562 6.562 0 0 1-6.036-4h.218c3.6 0 6.545-2.945 6.545-6.545 0-.91-.182-1.745-.509-2.545m0-1.455c-.473 0-.909.218-1.2.618-.29.4-.327.946-.145 1.382.254.655.4 1.31.4 2 0 2.8-2.291 5.09-5.091 5.09h-.218c-.473 0-.91.22-1.2.62-.291.4-.328.945-.146 1.38C1.891 14.074 4.764 16 8 16c4.4 0 8-3.6 8-8a7.972 7.972 0 0 0-7.745-8h-.037Z"})})})},vn=function(n){var a=n.onSetThemeMode;return[{icon:se.auto,label:"Auto",key:"auto",onClick:function(){return a("auto")}},{icon:se.light,label:"Light",key:"light",onClick:function(){return a("light")}},{icon:se.dark,label:"Dark",key:"dark",onClick:function(){return a("dark")}}]},ie={default:(0,e.jsx)(be.Z,{}),straight:(0,e.jsx)(un.Z,{}),step:(0,e.jsx)(mn.Z,{}),smoothstep:(0,e.jsx)(hn.Z,{})},ra=function(n){var a=n.onEdgesType;return[{icon:ie.default,label:"Bezier",key:"default",onClick:function(){return a("default")}},{icon:ie.straight,label:"Straight",key:"straight",onClick:function(){return a("straight")}},{icon:ie.step,label:"Step",key:"step",onClick:function(){return a("step")}},{icon:ie.smoothstep,label:"SmoothStep",key:"smoothstep",onClick:function(){return a("smoothstep")}}]},je=o(7174),fn=o(1794),ee=o(3406),xn=[{label:"Flow Editor",value:"flow"},{label:"Gallery",value:"gallery"}],Cn=function(n){var a=n.children,r=Y.ZP.useMessage(),l=T()(r,2),d=l[0],p=l[1],m=(0,s.useState)(0),b=T()(m,2),u=b[0],c=b[1],v=(0,s.useState)(!1),C=T()(v,2),f=C[0],g=C[1],i=(0,X.q)(function(V){return V},q.X),j=i.page,y=i.onSetPage,x=i.themeMode,S=i.onSetThemeMode,k=i.onSubmit,D=i.queue,I=i.onDeleteFromQueue,M=i.promptError,w=i.onEdgesAnimate,N=i.edgeType,P=i.onEdgesType;(0,s.useEffect)(function(){M!==void 0&&d.open({type:"error",content:M,duration:4})},[M,u,d]),(0,s.useEffect)(function(){w(D.length>0)},[D,w]);var Z=(0,s.useCallback)(function(){k(),c(function(V){return V+1})},[k]),W=(0,s.useCallback)(te()(U()().mark(function V(){var A,E,G,Q,H;return U()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.prev=0,A=X.q.getState(),E=(0,ee.Mg)(A),G=(0,fn.Fh)({graph:E,widgets:A.widgets,customWidgets:A.customWidgets,clientId:A.clientId}),Q=G.prompt,g(!0),L.next=8,je.Z.post("http://".concat("localhost:8188","/install_model"),{workflow:Q},{headers:{"Content-Type":"application/json"}});case 8:H=L.sent,g(!1),H.data.status===!0?Y.ZP.success("Models installed successfully"):Y.ZP.error("Error installing models: ".concat(H.data.models_not_found.join(", "))),L.next=18;break;case 13:L.prev=13,L.t0=L.catch(0),g(!1),console.error("Error installing models:",L.t0),Y.ZP.error("Failed to install models. Please try again later.");case 18:case"end":return L.stop()}},V,null,[[0,13]])})),[]),B=D.length>0;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(gn,{children:[(0,e.jsx)("div",{}),(0,e.jsx)(ln,{options:xn,value:j,onChange:y}),(0,e.jsxs)(F.Z,{children:[a,(0,e.jsx)(xe.Z,{trigger:["click"],placement:"bottomRight",menu:{items:vn({onSetThemeMode:S})},children:(0,e.jsx)(z.ZP,{icon:se[x]})}),(0,e.jsx)(z.ZP,{type:"default",color:"default",variant:"solid",onClick:W,loading:f,children:"Install Missing Models"}),(0,e.jsx)(xe.Z.Button,{type:"primary",trigger:["hover"],placement:"bottomRight",onClick:Z,menu:{items:pn({queue:D,onDeleteFromQueue:I})},icon:B?(0,e.jsx)(Ce.Z,{size:"small",indicator:(0,e.jsx)(fe.Z,{spin:!0,style:{color:"#fff"}})}):void 0,disabled:f,children:"Run Queue"})]})]}),p]})},yn=s.memo(Cn),Sn=o(2092),le=o.n(Sn),bn=o(6909),jn=o(2766),kn=o(5018),Pn=o(5994),Dn=o(2151),wn=o(6958),ke=o(3251),Pe,De,we,Ae,Ee,Oe,Ie,Te,Re,Ne,Ze,Me,Le,ze=(0,h.kc)(function(t,n){var a=t.token,r=(0,h.iv)(Pe||(Pe=O()([`
    position: relative;
    &::before {
      content: '';
      position: absolute;
      z-index: 50;
      transition: all 0.3s ease-in-out;
    }

    &:hover,
    &:active {
      &::before {
        background: `,`;
      }
    }
  `])),a.colorPrimary),l=(0,h.iv)(De||(De=O()([`
    cursor: pointer;

    position: absolute;
    z-index: 1001;

    color: `,`;

    opacity: 0;
    background: `,`;
    border-color: `,`;
    border-style: solid;
    border-width: 1px;
    border-radius: 4px;

    transition: opacity 0.1s;

    &:hover {
      color: `,`;
      background: `,`;
    }
  `])),a.colorTextTertiary,a.colorBgElevated,a.colorBorder,a.colorTextSecondary,a.colorFillQuaternary),d=17,p=40,m=16;return{container:(0,h.cx)(n,(0,h.iv)(we||(we=O()([`
        position: relative;
        flex-shrink: 0;
        border: 0 solid `,`;

        &:hover {
          .`,`-toggle {
            opacity: 1;
          }
        }
      `])),a.colorSplit,n)),toggleLeft:(0,h.cx)("".concat(n,"-toggle"),"".concat(n,"-toggle-left"),l,(0,h.iv)(Ae||(Ae=O()([`
        top: 50%;
        left: -`,`px;

        width: `,`px;
        height: `,`px;
        margin-top: -20px;

        border-right-width: 0;
        border-radius: 4px 0 0 4px;
      `])),d,m,p)),toggleRight:(0,h.cx)("".concat(n,"-toggle"),"".concat(n,"-toggle-right"),l,(0,h.iv)(Ee||(Ee=O()([`
        top: 50%;
        right: -`,`px;

        width: `,`px;
        height: `,`px;
        margin-top: -20px;

        border-left-width: 0;
        border-radius: 0 4px 4px 0;
      `])),d,m,p)),toggleTop:(0,h.cx)("".concat(n,"-toggle"),"".concat(n,"-toggle-top"),l,(0,h.iv)(Oe||(Oe=O()([`
        top: -`,`px;
        left: 50%;

        width: `,`px;
        height: `,`px;
        margin-left: -20px;

        border-bottom-width: 0;
        border-radius: 4px 4px 0 0;
      `])),d,p,m)),toggleBottom:(0,h.cx)("".concat(n,"-toggle"),"".concat(n,"-toggle-bottom"),l,(0,h.iv)(Ie||(Ie=O()([`
        bottom: -`,`px;
        left: 50%;

        width: `,`px;
        height: 16px;
        margin-left: -20px;

        border-top-width: 0;
        border-radius: 0 0 4px 4px;
      `])),d,p)),fixed:(0,h.cx)("".concat(n,"-fixed"),(0,h.iv)(Te||(Te=O()([`
        overflow: hidden;
        background: `,`;
      `])),a.colorBgContainer)),float:(0,h.cx)("".concat(n,"-float"),(0,h.iv)(Re||(Re=O()([`
        z-index: 2000;

        overflow: hidden;

        background: `,`;
        border-radius: 8px;
        box-shadow: `,`;
      `])),a.colorBgElevated,a.boxShadowSecondary)),leftHandle:(0,h.cx)((0,h.iv)(Ne||(Ne=O()([`
        `,`;

        &::before {
          left: 50%;
          width: 2px;
          height: 100%;
        }
      `])),r),"".concat(n,"-left-handle")),rightHandle:(0,h.cx)((0,h.iv)(Ze||(Ze=O()([`
        `,`;
        &::before {
          right: 50%;
          width: 2px;
          height: 100%;
        }
      `])),r),"".concat(n,"-right-handle")),topHandle:(0,h.cx)("".concat(n,"-top-handle"),(0,h.iv)(Me||(Me=O()([`
        `,`;

        &::before {
          top: 50%;
          width: 100%;
          height: 2px;
        }
      `])),r)),bottomHandle:(0,h.cx)("".concat(n,"-bottom-handle"),(0,h.iv)(Le||(Le=O()([`
        `,`;

        &::before {
          bottom: 50%;
          width: 100%;
          height: 2px;
        }
      `])),r))}}),An=150,En=400,de=function(n){switch(n){case"bottom":return"top";case"top":return"bottom";case"right":return"left";case"left":return"right"}},On=(0,s.memo)(function(t){var n=t.children,a=t.placement,r=a===void 0?"right":a,l=t.resize,d=t.style,p=t.size,m=t.defaultSize,b=t.minWidth,u=t.minHeight,c=t.prefixCls,v=t.onSizeChange,C=t.onSizeDragging,f=t.expandable,g=f===void 0?!0:f,i=t.isExpand,j=t.onExpandChange,y=t.className,x=(0,K.k2)("draggable-panel",c),S=r==="top"||r==="bottom",k=ze(x),D=k.styles,I=k.cx,M=(0,ke.Z)(!0,{value:i,onChange:j}),w=T()(M,2),N=w[0],P=w[1],Z=l!==!1&&N,W=(0,s.useMemo)(function(){return Z?le()({},de(r),D["".concat(de(r),"Handle")]):{}},[Z,r]),B=R()(le()({top:!1,bottom:!1,right:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},de(r),!0),l),V=(0,s.useMemo)(function(){return S?R()({width:"100%",height:An},m):R()({width:En,height:"100%"},m)},[S]),A=N?{minWidth:typeof b=="number"?Math.max(b,0):280,minHeight:typeof u=="number"?Math.max(u,0):void 0,defaultSize:V,size:p,style:d}:{minWidth:0,minHeight:0,size:{width:0,height:0}},E=(0,s.useMemo)(function(){switch(r){case"top":return{className:"Bottom",Arrow:bn.Z};case"bottom":return{className:"Top",Arrow:jn.Z};case"right":return{className:"Left",Arrow:kn.Z};case"left":return{className:"Right",Arrow:Pn.Z}}},[D,r]),G=E.Arrow,Q=E.className;return(0,e.jsxs)("div",{className:I(D.container,y),style:le()({},"border".concat(Q,"Width"),1),children:[g&&(0,e.jsx)(wn.Z,{className:I(D["toggle".concat(Q)]),onClick:function(){P(!N)},style:{opacity:N?void 0:1},children:(0,e.jsx)(G,{rotate:N?180:0})}),(0,e.jsx)(Dn.e,R()(R()({},A),{},{className:D.fixed,enable:Z?B:void 0,handleClasses:W,onResizeStop:function(J,L,re,he){v==null||v(he,{width:re.style.width,height:re.style.height})},onResize:function(J,L,re,he){C==null||C(he,{width:re.style.width,height:re.style.height})},children:n}))]})}),In=o(4934),Tn=300,Rn=400,Nn=(0,s.memo)(function(t){var n=t.children,a=t.direction,r=t.resize,l=t.style,d=t.position,p=t.onPositionChange,m=t.size,b=t.defaultSize,u=t.defaultPosition,c=t.minWidth,v=c===void 0?280:c,C=t.minHeight,f=C===void 0?200:C,g=t.prefixCls,i=t.canResizing,j=ze(g),y=j.styles,x=(0,s.useMemo)(function(){return i?{right:y.rightHandle,left:y.leftHandle,top:y.topHandle,bottom:y.bottomHandle}:{}},[i,a]),S=(0,s.useMemo)(function(){return i?r:R()({top:!0,bottom:!0,right:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},r)},[i,r]),k=R()({width:Rn,height:Tn},b),D=R()({x:100,y:100},u),I={minWidth:Math.max(v,0),minHeight:Math.max(f,0),defaultSize:k,size:m,style:l};return(0,e.jsx)(In.s,R()(R()({position:d,resizeHandleClasses:x,default:R()(R()({},D),k),onDragStop:function(w,N){p==null||p({x:N.x,y:N.y})},bound:"parent",enableResizing:S},I),{},{className:y.float,children:n}))}),Zn=(0,s.memo)(function(t){var n=t.children,a=t.className,r=t.mode,l=t.placement,d=l===void 0?"right":l,p=t.resize,m=t.style,b=t.position,u=t.onPositionChange,c=t.size,v=t.defaultSize,C=t.defaultPosition,f=t.minWidth,g=t.minHeight,i=t.prefixCls,j=t.onSizeChange,y=t.onSizeDragging,x=t.expandable,S=x===void 0?!0:x,k=t.isExpand,D=t.onExpandChange,I=(0,K.k2)("draggable-panel",i);switch(r){case"fixed":default:return(0,e.jsx)(On,{prefixCls:I,size:c,defaultSize:v,onSizeDragging:y,onSizeChange:j,minHeight:g,minWidth:f,resize:p,onExpandChange:D,expandable:S,isExpand:k,className:a,placement:d,style:m,children:n});case"float":return(0,e.jsx)(Nn,{prefixCls:I,defaultPosition:C,position:b,onPositionChange:u,minHeight:g,minWidth:f,defaultSize:v,size:c,onSizeDragging:y,onSizeChange:j,resize:p,canResizing:p!==!1,className:a,style:m,children:n})}}),Mn=o(385),Ln=o(7911),zn=o(2655),ae=o(1074),We=o(4412),pe=o(1534),Wn=_.ZP.div.withConfig({componentId:"sc-1i4gfeb-0"})(["height:100%;display:flex;flex-direction:column;padding:0px;"]),Hn=_.ZP.div.withConfig({componentId:"sc-1i4gfeb-1"})(["display:flex;flex-direction:column;flex:1;overflow-y:auto;margin-bottom:16px;"]),Fn=_.ZP.div.withConfig({componentId:"sc-1i4gfeb-2"})(["background-color:",";align-self:",";padding:8px 10px;border-radius:8px;max-width:70%;word-break:break-word;display:flex;flex-direction:column;"],function(t){return t.$sender==="user"?"#e6f7ff":"#f0f0f0"},function(t){return t.$sender==="user"?"flex-end":"flex-start"}),_n=_.ZP.div.withConfig({componentId:"sc-1i4gfeb-3"})(["font-size:0.8em;color:#666;margin-top:4px;cursor:pointer;transition:color 0.3s ease;&:hover{color:#1890ff;}"]),Un=function(){var n=(0,X.q)(function(x){return x},q.X),a=n.messages,r=n.onAddMessage,l=(0,s.useRef)(null),d=(0,s.useState)(""),p=T()(d,2),m=p[0],b=p[1],u=Y.ZP.useMessage(),c=T()(u,2),v=c[0],C=c[1],f=(0,X.q)(function(x){return x},q.X),g=f.onLoadWorkflow,i=function(){var S;(S=l.current)===null||S===void 0||S.scrollIntoView({behavior:"smooth"})};(0,s.useEffect)(function(){i()},[a]);var j=(0,s.useCallback)(function(){var x=te()(U()().mark(function S(k){return U()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,g(k);case 2:v.success("Success! Workflow have been loaded.");case 3:case"end":return I.stop()}},S)}));return function(S){return x.apply(this,arguments)}}(),[v]),y=(0,s.useCallback)(te()(U()().mark(function x(){var S,k,D,I,M,w;return U()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(m.trim()){P.next=2;break}return P.abrupt("return");case 2:return S={content:[{text:m}],sender:"user"},r(S),b(""),P.prev=5,P.next=8,je.Z.post("http://localhost:8000/completion",{query:m});case 8:k=P.sent,D=k.data,I=D.data.map(function(Z){return{text:Z.description,name:Z.name,metadata:Z.metadata}}),M={content:I,sender:"bot"},r(M),P.next=20;break;case 15:P.prev=15,P.t0=P.catch(5),console.error("Error sending message:",P.t0),w={content:[{text:"Failed to get a response from the server."}],sender:"bot"},r(w);case 20:case"end":return P.stop()}},x,null,[[5,15]])})),[m]);return(0,e.jsxs)(e.Fragment,{children:[C,(0,e.jsxs)(Wn,{children:[(0,e.jsxs)(Hn,{children:[(0,e.jsx)(ae.Z,{dataSource:a,renderItem:function(S){return(0,e.jsxs)(ae.Z.Item,{style:{display:"flex",justifyContent:S.sender==="user"?"flex-end":"flex-start",alignItems:"flex-start",border:"none",width:"100%",padding:"4px",gap:"8px",maxWidth:"100%"},children:[S.sender==="bot"&&(0,e.jsx)(Mn.Z,{style:{color:"#1890ff"}}),(0,e.jsx)(Fn,{$sender:S.sender,children:S.content.map(function(k,D){return(0,e.jsxs)("div",{children:[k.name&&(0,e.jsx)("h3",{children:k.name}),k.text,k.metadata&&(0,e.jsx)(We.Z,{title:"Click to import",placement:"right",children:(0,e.jsxs)(_n,{onClick:function(){return j(k.metadata)},children:[(0,e.jsx)(Ln.Z,{style:{marginRight:4}}),k.name]})})]},"content-".concat(D))})})]})}}),(0,e.jsx)("div",{ref:l})]}),(0,e.jsxs)(F.Z.Compact,{style:{width:"100%"},children:[(0,e.jsx)(pe.Z,{placeholder:"What type of workflow are you looking for?",value:m,onPressEnter:y,onChange:function(S){return b(S.target.value)}}),(0,e.jsx)(z.ZP,{icon:(0,e.jsx)(zn.Z,{}),type:"primary",onClick:y,children:"Send"})]})]})]})},Bn=s.memo(Un),Vn=o(335),Gn=o.n(Vn),$n=o(7979),Qn=o(3745),Kn=o(7146),Xn=o(4359),Jn=o(6952),ue=o(1012),oe=o(262),Yn=_.ZP.div.withConfig({componentId:"sc-1mc9338-0"})(["margin-top:6px;background:",";"],function(t){var n=t.isRequired,a=t.theme;return n?a.colorPrimary:a.colorBorder}),qn=function(n){var a=n.data,r=(0,s.useMemo)(function(){return a.output.map(function(u){return{name:u,type:u}})},[a.output]),l=(0,s.useMemo)(function(){var u=[],c=[];return Object.entries(a.input.required).forEach(function(v){var C=T()(v,2),f=C[0],g=C[1];Jn.l.isParameterOrList(g)?u.push({name:f,type:g[0],input:g}):c.push({name:f,type:g[0]})}),[u,c]},[a.input.required]),d=T()(l,2),p=d[0],m=d[1],b=(0,s.useCallback)(function(u){var c=u.item,v=u.position,C=u.isRequired;return(0,e.jsxs)("h5",{children:[(0,e.jsx)(Yn,{className:"react-flow__handle",style:le()({},v,-3),isRequired:C}),(0,ue.Z)(c.name)]})},[]);return(0,e.jsxs)(oe.OE,{size:"small",title:a.name,active:0,style:{minWidth:240},children:[(0,e.jsxs)(oe.VA,{children:[(0,e.jsx)(oe.zw,{children:m.map(function(u,c){return(0,e.jsx)(b,{item:u,position:"left",isRequired:1},c)})}),(0,e.jsx)(oe.zw,{style:{textAlign:"right"},children:r.map(function(u,c){return(0,e.jsx)(b,{item:u,position:"right",isRequired:1},c)})})]}),(0,e.jsx)(oe.zw,{children:p.map(function(u,c){return(0,e.jsx)(b,{item:u,position:"left",isRequired:0},c)})})]})},He=s.memo(qn),et=o(2337),nt=o(8865),me=o(9629),Fe,_e,Ue,Be,tt=(0,h.kc)(function(t,n){var a=t.token,r=t.stylish,l=n.prefixCls,d=n.className,p=n.showPanel;return{container:(0,h.cx)(l,d,p?(0,h.iv)(Fe||(Fe=O()([`
            margin-bottom: 8px;
            padding: 6px 8px 12px 8px;
            background: `,`;
            border-radius: 4px;
          `])),a.colorFillQuaternary):""),header:(0,h.cx)(p?"".concat(l,"-expand"):"".concat(l,"-collapsed"),p?"":(0,h.iv)(_e||(_e=O()([`
            user-select: none;
            padding: 6px 8px;
            border-radius: 4px;
            `,`
          `])),r.containerBgL2)),title:(0,h.cx)((0,h.iv)(Ue||(Ue=O()([`
        height: 24px;
      `]))),p?(0,h.iv)(Be||(Be=O()([`
            user-select: none;
            margin-left: -4px;
            padding: 4px;
            border-radius: 4px;

            `,`
          `])),r.containerBgHover):"")}}),at=function(n){var a=n.defaultExpand,r=a===void 0?!1:a,l=n.expand,d=n.onExpandChange,p=n.prefixCls,m=n.title,b=n.children,u=n.className,c=n.extra,v=(0,K.k2)("collapse-title",p),C=(0,ke.Z)(r,{value:l,onChange:d}),f=T()(C,2),g=f[0],i=f[1],j=function(){i(!g)},y=tt({showPanel:g,prefixCls:v,className:u}),x=y.styles;return(0,e.jsx)(ne.i,{children:(0,e.jsxs)(me.D,{className:x.container,children:[(0,e.jsxs)(me.D,{direction:"horizontal",distribution:"space-between",align:"center",className:x.header,onClick:g?void 0:j,children:[(0,e.jsxs)(me.D,{direction:"horizontal",gap:4,align:"center",onClick:g?j:void 0,className:x.title,children:[(0,e.jsx)(et.Z,{style:{fontSize:10},rotate:g?90:0}),(0,e.jsx)("div",{children:m})]}),c&&c(g)]}),g?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(nt.Z,{style:{margin:"4px 0 12px"},dashed:!0}),b]}):null]})})},ot=at,rt=o(3483),st="8px 4px",it=_.ZP.div.withConfig({componentId:"sc-fv8tvn-0"})(["cursor:pointer;padding:",";"],st),lt=function(n){var a=n.cat,r=n.data,l=n.onAddNode,d=n.globalExpand,p=n.cardView,m=(0,s.useState)(!0),b=T()(m,2),u=b[0],c=b[1];(0,s.useEffect)(function(){c(d)},[d]);var v=(0,s.useCallback)(function(i,j){i.dataTransfer.setData("application/reactflow",JSON.stringify(j)),i.dataTransfer.effectAllowed="move"},[]),C=(0,s.useCallback)(function(){return(0,e.jsx)("div",{children:r.map(function(i){return(0,e.jsx)(it,{draggable:!0,onDragStart:function(y){return v(y,i)},onClick:function(){return l({widget:i})},children:(0,e.jsx)(He,{data:i})},i.name)})})},[r,v,l]),f=(0,s.useCallback)(function(){return(0,e.jsx)(F.Z,{wrap:!0,align:"baseline",children:r.map(function(i){return(0,e.jsx)(rt.Z,{content:(0,e.jsx)(He,{data:i}),placement:"left",overlayStyle:{pointerEvents:"none"},destroyTooltipOnHide:!0,children:(0,e.jsx)(z.ZP,{onClick:function(){return l({widget:i})},draggable:!0,onDragStart:function(y){return v(y,i)},children:(0,ue.Z)(i.name)})},i.name)})})},[r,v,l]),g=(0,s.useCallback)(function(i){c(i)},[]);return(0,e.jsx)(ot,{title:(0,ue.Z)(a),expand:u,onExpandChange:g,children:p?C():f()},a)},ct=s.memo(lt),Ve=_.ZP.div.withConfig({componentId:"sc-e793qc-0"})(["display:flex;margin-bottom:8px;"]),Ge=_.ZP.div.withConfig({componentId:"sc-e793qc-1"})(["overflow:auto;flex:1;"]),dt=pe.Z.Search,pt=function(){var n=(0,X.q)(function(w){return w},q.X),a=n.widgets,r=n.onAddNode,l=(0,s.useState)({}),d=T()(l,2),p=d[0],m=d[1],b=(0,s.useState)(""),u=T()(b,2),c=u[0],v=u[1],C=(0,s.useState)(!0),f=T()(C,2),g=f[0],i=f[1],j=(0,s.useState)(!1),y=T()(j,2),x=y[0],S=y[1];(0,s.useEffect)(function(){var w={},N=Object.values(a);c&&(N=N.filter(function(B){return B.name.toLowerCase().includes(c.toLowerCase())}));var P=Gn()(N),Z;try{for(P.s();!(Z=P.n()).done;){var W=Z.value;w[W.category]?w[W.category].push(W):w[W.category]=[W]}}catch(B){P.e(B)}finally{P.f()}m(w)},[a,c]);var k=(0,s.useCallback)(function(w){v(w.target.value)},[]),D=(0,s.useCallback)(function(){S(function(w){return!w})},[]),I=(0,s.useCallback)(function(){i(!0)},[]),M=(0,s.useCallback)(function(){i(!1)},[]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Ve,{children:[(0,e.jsx)(dt,{placeholder:"Input search text",onChange:k,style:{width:"100%"}}),(0,e.jsxs)(F.Z.Compact,{style:{marginLeft:8},children:[(0,e.jsx)(z.ZP,{title:"Switch Card/List View",icon:x?(0,e.jsx)($n.Z,{}):(0,e.jsx)(Qn.Z,{}),onClick:D}),(0,e.jsx)(z.ZP,{title:"Expand All",icon:(0,e.jsx)(Kn.Z,{}),onClick:I}),(0,e.jsx)(z.ZP,{title:"Collapse All",icon:(0,e.jsx)(Xn.Z,{}),onClick:M})]})]}),(0,e.jsx)(Ge,{children:Object.entries(p).map(function(w){var N=T()(w,2),P=N[0],Z=N[1];return(0,e.jsx)(ct,{data:Z,cat:P,onAddNode:r,globalExpand:g,cardView:x},P)})})]})},ut=s.memo(pt),mt=o(858),$e=o(3603),ht=o(1203),Qe=o(4566),gt=o(4322),vt=o(4194),ft=o(6597),xt=o(4434),Ct=o(7825),yt=o.n(Ct),St=o(5955),Ke,Xe,Je,bt=(0,h.kc)(function(t,n){var a=t.token,r=n.size,l=n.className,d=n.prefixCls,p=typeof r=="number"?(0,h.iv)(Ke||(Ke=O()([`
          width: `,`px !important;
          height: `,`px !important;
        `])),r,r):"",m=(0,h.iv)(Xe||(Xe=O()([`
    display: flex;
    align-items: center;
    justify-content: center;

    &:hover {
      color: `,` !important;
    }
  `])),a.colorText);return{container:(0,h.cx)(d,m,p,l),tooltip:(0,h.iv)(Je||(Je=O()([`
      pointer-events: none;
    `])))}}),jt=["placement","title","icon","cursor","onClick","className","size","prefixCls"],kt=function(n){var a=n.placement,r=n.title,l=n.icon,d=n.cursor,p=n.onClick,m=n.className,b=n.size,u=n.prefixCls,c=yt()(n,jt),v=(0,K.k2)("actionicon",u),C=bt({size:b,prefixCls:v}),f=C.styles,g=(0,St.S)(),i=(0,e.jsx)(z.ZP,R()(R()({icon:l,className:(0,h.cx)(m,f.container),type:"text",style:{cursor:d},size:"small"},c),{},{onClick:p}));return(0,e.jsx)(ne.i,{componentToken:{Button:{colorText:g.colorTextTertiary,colorBgTextHover:g.colorFillSecondary,colorBgTextActive:g.colorFill}},children:r?(0,e.jsx)(We.Z,{showArrow:!1,align:{offset:[0,-5]},overlayClassName:f.tooltip,title:r,placement:a,children:i}):i})},Pt=kt,ce=Pt,Dt=o(5135),wt=o(9422),At=o(6668),Et=o(6142),Ot=o(1915),It=o(6483),Tt=o.n(It),Rt=function(n){var a=n.item,r=n.index,l=n.handleRename,d=n.handleUpdate,p=n.handleDelete,m=n.handleLoad,b=(0,s.useState)(!1),u=T()(b,2),c=u[0],v=u[1],C=(0,s.useCallback)(function(S){v(!1);var k=S.target.value;k&&l(a.id,k)},[l,a.id]),f=(0,s.useCallback)(function(){m(a.graph,a.title)},[m,a.graph,a.title]),g=(0,s.useCallback)(function(){v(!0)},[]),i=(0,s.useCallback)(function(){d(a.id,a.title)},[d,a.id,a.title]),j=(0,s.useCallback)(function(){(0,ee.Cq)(a.graph,a.title)},[a.graph,a.title]),y=(0,s.useCallback)(function(){p(a.id,a.title)},[p,a.id,a.title]),x=(0,s.useCallback)(function(){return c?(0,e.jsx)(xt.I,{defaultValue:a.title,onBlur:C,onPressEnter:C}):(0,e.jsxs)("a",{title:"Load",onClick:f,children:[a.title,r===0&&(0,e.jsx)(Et.Z,{color:"blue",style:{marginLeft:4},children:"Recent"})]})},[c,a.title,r,C,f]);return(0,e.jsx)(ae.Z.Item,{extra:(0,e.jsxs)(F.Z.Compact,{children:[(0,e.jsx)(ce,{title:"Rename",icon:(0,e.jsx)(Dt.Z,{}),onClick:g}),(0,e.jsx)(ce,{title:"Update",icon:(0,e.jsx)($e.Z,{}),onClick:i}),(0,e.jsx)(ce,{title:"Download",icon:(0,e.jsx)(Qe.Z,{}),onClick:j}),(0,e.jsx)(ce,{title:"Delete",icon:(0,e.jsx)(ye.Z,{}),onClick:y})]}),children:(0,e.jsx)(ae.Z.Item.Meta,{avatar:(0,e.jsx)("a",{title:"Load",onClick:f,children:(0,e.jsx)(Ot.C,{size:44,shape:"square",children:a.title[0].toUpperCase()})}),title:x(),description:(0,e.jsxs)(F.Z,{size:10,align:"center",children:[(0,e.jsxs)(F.Z,{size:4,align:"center",children:[(0,e.jsx)(wt.Z,{}),Object.keys(a.graph.data).length]}),(0,e.jsxs)(F.Z,{size:4,align:"center",children:[(0,e.jsx)(be.Z,{}),a.graph.connections.length]}),(0,e.jsxs)(F.Z,{size:4,align:"center",children:[(0,e.jsx)(At.Z,{}),Tt()(a.time).format("YYYY-MM-DD HH:mm:ss")]})]})})},a.id)},Nt=s.memo(Rt),Zt=function(){var n=Y.ZP.useMessage(),a=T()(n,2),r=a[0],l=a[1],d=(0,s.useState)(),p=T()(d,2),m=p[0],b=p[1],u=(0,s.useState)(),c=T()(u,2),v=c[0],C=c[1],f=(0,s.useState)(0),g=T()(f,2),i=g[0],j=g[1],y=(0,X.q)(function(A){return A},q.X),x=y.onLoadWorkflow,S=y.onDownloadWorkflow,k=y.onSaveLocalWorkFlow,D=y.onUpdateLocalWorkFlowGraph,I=y.onUpdateLocalWorkFlowTitle,M=(0,s.useCallback)(function(){k(m),j(i+1),r.success("Success! ".concat(m!=null?m:"Your workflow"," have been saved."))},[i,r,k,m]),w=(0,s.useCallback)(function(A,E){(0,ee.Sf)(A),j(i+1),r.info("".concat(E," has been deleted."))},[i,r]),N=(0,s.useCallback)(function(){var A=te()(U()().mark(function E(G,Q){return U()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return console.log("before onLoadWorkflow"),J.next=3,x(G);case 3:console.log("after onLoadWorkflow"),j(i+1),r.success("Success! ".concat(Q," have been loaded."));case 6:case"end":return J.stop()}},E)}));return function(E,G){return A.apply(this,arguments)}}(),[i,r,x]),P=(0,s.useCallback)(function(){var A=te()(U()().mark(function E(G){return U()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return console.log("before onLoadWorkflow"),H.next=3,(0,ee.Sk)(G,x);case 3:console.log("after onLoadWorkflow"),j(i+1),r.success("Success! the workflow have been loaded.");case 6:case"end":return H.stop()}},E)}));return function(E){return A.apply(this,arguments)}}(),[i,r,x]),Z=(0,s.useCallback)(function(A,E){D(A),j(i+1),r.success("Success! ".concat(E," have been update."))},[i,r,D]),W=(0,s.useCallback)(function(A,E){I(A,E),j(i+1),r.success("Success! the workflow have been renamed to ".concat(E," ."))},[i,r,I]),B=(0,s.useCallback)(function(){(0,ee.W)(),x(mt.Z),j(i+1),r.success("Success! load default workflow.")},[i,r,x]);(0,s.useEffect)(function(){C((0,ee.qW)().sort(function(A,E){return E.time-A.time}))},[i]);var V=(0,s.useCallback)(function(A,E){return(0,e.jsx)(Nt,{item:A,index:E,handleLoad:N,handleUpdate:Z,handleDelete:w,handleRename:W})},[w,N,W,Z]);return(0,e.jsxs)(e.Fragment,{children:[l,(0,e.jsxs)(Ve,{children:[(0,e.jsxs)(F.Z.Compact,{style:{width:"100%"},children:[(0,e.jsx)(pe.Z,{placeholder:"Name the workflow to save",onChange:function(E){return b(E.target.value)}}),(0,e.jsx)(z.ZP,{icon:(0,e.jsx)($e.Z,{}),type:"primary",onClick:M,children:"Save"})]}),(0,e.jsxs)(F.Z.Compact,{style:{marginLeft:8},children:[(0,e.jsx)(z.ZP,{title:"New",icon:(0,e.jsx)(ht.Z,{}),onClick:B}),(0,e.jsx)(z.ZP,{title:"Download",icon:(0,e.jsx)(Qe.Z,{}),onClick:S}),(0,e.jsx)(vt.Z,{accept:".json",maxCount:1,itemRender:function(){return null},beforeUpload:P,children:(0,e.jsx)(z.ZP,{title:"Upload",icon:(0,e.jsx)(gt.Z,{})})})]})]}),(0,e.jsxs)(Ge,{children:[(0,e.jsx)("h5",{children:"Local Workflows"}),(v==null?void 0:v.length)===0?(0,e.jsx)(ft.Z,{style:{marginTop:"40vh"},image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",description:"Nothing here yet!"}):(0,e.jsx)(ae.Z,{dataSource:v,renderItem:V})]})]})},Mt=s.memo(Zt),Lt=o(5928),Ye,zt=(0,h.kc)(function(t){var n=t.token,a=t.prefixCls,r=t.css,l=t.stylish,d=".".concat(a,"-tabs");return{cls:r(Ye||(Ye=O()([`
      position: relative;

      display: flex;
      flex: 1;
      flex-direction: column;

      max-height: 100%;

      `,"-tab + ",`-tab {
        margin: 8px 4px !important;
        padding: 0 12px !important;
      }

      `,`-tab {
        color: `,`;
        transition: background-color 150ms ease-out;

        &:first-child {
          margin: 8px 4px 8px 0;
          padding: 4px 12px !important;
        }

        &:hover {
          color: `,` !important;
          background: `,`;
          border-radius: 4px;
        }
      }

      `,`-nav {
        position: relative;
        z-index: 10;

        flex: none;

        width: 100%;
        height: 46px;
        margin: 0;
        padding: 0 12px;

        `,`;
      }

      `,`-content {
        height: 100%;
      }

      `,`-tabpane-active {
        display: flex;
        flex-direction: column;
        height: 100%;
      }

      `,`-content-holder {
        overflow-y: auto;
        flex: 1;
        padding: 8px 12px;
      }
    `])),d,d,d,n.colorTextSecondary,n.colorText,n.colorFillTertiary,d,l.backgroundBlur,d,d,d)}}),Wt=function(n){var a=zt(),r=a.styles,l=a.cx;return(0,e.jsx)(ne.i,{children:(0,e.jsx)(Lt.Z,R()(R()({},n),{},{className:l(n.className,r.cls)}))})},$=function(t){return t.NODES="Nodes",t.WORKFLOW="Workflow",t.CHATBOT="Chatbot",t}($||{}),Ht=_.ZP.div.withConfig({componentId:"sc-2jub1t-0"})(["display:flex;flex-direction:column;height:100%;"]),Ft=function(){var n=(0,s.useMemo)(function(){return[{label:$.CHATBOT,key:$.CHATBOT,children:(0,e.jsx)(Bn,{})},{label:$.NODES,key:$.NODES,children:(0,e.jsx)(ut,{})},{label:$.WORKFLOW,key:$.WORKFLOW,children:(0,e.jsx)(Mt,{})}]},[]);return(0,e.jsx)(Ht,{children:(0,e.jsx)(Wt,{defaultActiveKey:$.CHATBOT,items:n})})},_t=s.memo(Ft),Ut=o(8775),sa=o(8316),Bt=o(5791),Vt=o(8314),qe,Gt=(0,h.vJ)(qe||(qe=O()([`
  body {
    color: `,`;
    background: `,`;
  }

  div {
    user-select: none;
  }

  code,.react-json-view {
    font-family: 'Hack', 'IBM Plex Mono', 'ui-monospace', 'Consolas', monospace !important;
  }

  .react-flow__node[type="Group"] {
    pointer-events: none !important;
    z-index: -1 !important;
  }

  .react-flow__handle {
    width: 8px;
    height: 8px;
    border-radius: 4px;
  }

  .ant-card[type="Reroute"] .react-flow__handle {
    margin-top: 0;
  }


  .react-json-view {
    background: transparent !important;
  }

    /* width */
  ::-webkit-scrollbar {
    width: 6px;
  }

  /* Track */
  ::-webkit-scrollbar-track {
    border-radius: 10px;
  }

  /* Handle */
  ::-webkit-scrollbar-thumb {
    background: `,`;
    border-radius: 10px;
  }

  /* Handle on hover */
  ::-webkit-scrollbar-thumb:hover {
    background:  `,`;
  }




  .react-flow__handle-connecting {
    background: `,` !important;
  }

  .react-flow__handle-valid {
    background: `,` !important;
  }

  .react-flow__minimap-mask {
    fill: `,`;
  }

  .react-flow__minimap {
    overflow: hidden;

    height: 150px;

    background: `,`;
    /* backdrop-filter: blur(24px); */
    border: 1px solid `,`;
    border-radius: 4px;
    box-shadow: `,`;
  }

  .react-flow__minimap-node {
    opacity: .5;
  }

  .react-flow__attribution {
    display: none;
  }

  .react-flow__controls {
    border: 1px solid `,`;
    box-shadow: `,`;

    button {
      color: `,`;
      background-color: `,`;
      border-bottom: none;
      path {
        fill: currentColor;
      }
    }

    button + button {
      border-top: 1px solid `,`;
    }

    button:hover {
      background-color: `,`;
    }
  }
`])),function(t){var n=t.theme;return n.colorTextBase},function(t){var n=t.theme;return n.colorBgBase},function(t){var n=t.theme;return n.colorBorderSecondary},function(t){var n=t.theme;return n.colorBorder},function(t){var n=t.theme;return n.colorError},function(t){var n=t.theme;return n.colorSuccess},function(t){var n=t.theme;return n.colorBgMask},function(t){var n=t.theme;return(0,Vt.m4)(n.colorBgContainer,.8)},function(t){var n=t.theme;return n.colorBorderSecondary},function(t){var n=t.theme;return n.boxShadowTertiary},function(t){var n=t.theme;return n.colorBorder},function(t){var n=t.theme;return n.boxShadow},function(t){var n=t.theme;return n.colorTextBase},function(t){var n=t.theme;return n.colorBgElevated},function(t){var n=t.theme;return n.colorBorder},function(t){var n=t.theme;return n.colorBgSpotlight}),$t=Gt,Qt=o(1326),Kt=o(4456),Xt="ws://".concat(Qt.Z.host,"/ws"),Jt=function(){var n=(0,X.q)(function(u){var c;return R()(R()({},u),{},{nodeIdInProgress:(c=u.nodeInProgress)===null||c===void 0?void 0:c.id})},q.X),a=n.clientId,r=n.nodeIdInProgress,l=n.onNewClientId,d=n.onQueueUpdate,p=n.onNodeInProgress,m=n.onImageSave,b=(0,s.useCallback)(function(u){var c=JSON.parse(u.data),v={status:function(){c.data.sid!==void 0&&c.data.sid!==a&&l(c.data.sid),d()},executing:function(){c.data.node!==void 0?p(c.data.node,0):r!==void 0&&p(r,0)},progress:function(){r!==void 0&&p(r,c.data.value/c.data.max)},executed:function(){var i=c.data.output.images;Array.isArray(i)&&m(c.data.node,i)}},C=c.type,f=v[C];f&&f()},[a,r,l,d,p,m]);return(0,Kt.useWebSocket)(Xt,{onMessage:b,shouldReconnect:function(c){return!0},reconnectAttempts:10,reconnectInterval:5e3}),null},Yt=s.memo(Jt),qt=_.ZP.div.withConfig({componentId:"sc-1k2gi0p-0"})(["display:flex;width:100vw;height:100vh;"]),ea=function(){return(0,e.jsxs)(ne.i,{children:[(0,e.jsxs)(qt,{children:[(0,e.jsxs)(Ut.Z,{children:[(0,e.jsx)(yn,{}),(0,e.jsx)(Bt.j3,{})]}),(0,e.jsx)(Zn,{children:(0,e.jsx)(_t,{})})]}),(0,e.jsx)($t,{}),(0,e.jsx)(Yt,{})]})},na=ea}}]);
